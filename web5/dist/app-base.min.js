!function(){"use strict";function t(t,e){function i(t,e,o,r){if(ti.isEmpty(o)&&ti.isEmpty(e))return[];e=e||{},o=o||{},ti.isEmpty(t)&&ti.extend(t,n(e,o));var s=r[0],a=r.slice(1);if("*"===s){var h=[];for(var u in t)(l=t[u])&&(l.nobj=l.nobj||e[u],l.oobj=l.oobj||o[u],l.changes=l.changes||{},1===r.length?h.push({path:[u],new_val:l.nobj,old_val:l.oobj}):i(l.changes,l.nobj,l.oobj,a).forEach(function(t){t.path.unshift(u),h.push(t)}));return h}if(t[s]){var l=t[s];return l.nobj=l.nobj||e[s],l.oobj=l.oobj||o[s],l.changes=l.changes||{},1==r.length?[{path:[s],new_val:l.nobj,old_val:l.oobj}]:i(l.changes,l.nobj,l.oobj,a).map(function(t){return t.path.unshift(s),t})}return[]}if(t===e)return function(){return[]};var o=n(t,e);return function(n){return i(o,t,e,n)}}function e(t,e,n){return n.reduce(function(n,i){return ti.isEqual(t[i],e[i])?n:n.concat(i)},[])}function n(t,n){ti.isObject(t)||(t={}),ti.isObject(n)||(n={});var i=ti.uniq(Object.keys(t).concat(Object.keys(n))),o=e(t,n,i).sort();return ti.reduce(i,function(t,e){var n=ti.indexOf(o,e,!0);return-1!==n?(o.splice(n,1),t[e]={}):t[e]=null,t},{})}function i(t,e,n){var i=e.state.entities[t];return i&&i[n]||{}}function o(t){return t.state.selectedBase||{}}function r(t,e){return{fold:function(n,i){void 0===t?i(e):n(t)},right:e}}function s(t){var e,n,i,o;for(n=1,i=arguments.length;n<i;n++){o=arguments[n];for(e in o)t[e]=o[e]}return t}function a(t,e){var n=Array.prototype.slice;if(t.bind)return t.bind.apply(t,n.call(arguments,1));var i=n.call(arguments,2);return function(){return t.apply(e,i.length?i.concat(n.call(arguments)):arguments)}}function h(t){return t._leaflet_id=t._leaflet_id||++oi,t._leaflet_id}function u(t,e,n){var i,o,r,s;return s=function(){i=!1,o&&(r.apply(n,o),o=!1)},r=function(){i?o=arguments:(t.apply(n,arguments),setTimeout(s,e),i=!0)}}function l(t,e,n){var i=e[1],o=e[0],r=i-o;return t===i&&n?t:((t-o)%r+r)%r+o}function c(){return!1}function d(t,e){var n=Math.pow(10,e||5);return Math.round(t*n)/n}function f(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function p(t){return f(t).split(/\s+/)}function _(t,e){t.hasOwnProperty("options")||(t.options=t.options?ii(t.options):{});for(var n in e)t.options[n]=e[n];return t.options}function g(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}function m(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}function v(t){var e=+new Date,n=Math.max(0,16-(e-si));return si=e+n,window.setTimeout(t,n)}function y(t,e,n){if(!n||ai!==v)return ai.call(window,a(t,e));t.call(e)}function w(t){t&&hi.call(window,t)}function x(t,e,n){this.x=n?Math.round(t):t,this.y=n?Math.round(e):e}function b(t,e,n){return t instanceof x?t:ri(t)?new x(t[0],t[1]):void 0===t||null===t?t:"object"==typeof t&&"x"in t&&"y"in t?new x(t.x,t.y):new x(t,e,n)}function M(t,e){if(t)for(var n=e?[t,e]:t,i=0,o=n.length;i<o;i++)this.extend(n[i])}function P(t,e){return!t||t instanceof M?t:new M(t,e)}function k(t,e){if(t)for(var n=e?[t,e]:t,i=0,o=n.length;i<o;i++)this.extend(n[i])}function E(t,e){return t instanceof k?t:new k(t,e)}function T(t,e,n){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,void 0!==n&&(this.alt=+n)}function A(t,e,n){return t instanceof T?t:ri(t)&&"object"!=typeof t[0]?3===t.length?new T(t[0],t[1],t[2]):2===t.length?new T(t[0],t[1]):null:void 0===t||null===t?t:"object"==typeof t&&"lat"in t?new T(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===e?null:new T(t,e,n)}function C(t,e){return t&&0===t.indexOf(t)}function S(t){return t.map(function(t){return A(t[1],t[0])})}function z(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function D(t,e){var n,i,o,r,s,a,h="";for(n=0,o=t.length;n<o;n++){for(i=0,r=(s=t[n]).length;i<r;i++)a=s[i],h+=(i?"L":"M")+a.x+" "+a.y;h+=e?Gi?"z":"x":""}return h||"M0 0"}function B(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}function I(){}function N(t){if(L&&L.Mixin){t=ri(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: "+"this property will be removed in future releases, "+"please inherit from L.Evented instead.",(new Error).stack)}}function O(t,e){if(!e||!t.length)return t.slice();var n=e*e;return t=F(t,n),t=R(t,n)}function Z(t,e,n){return Math.sqrt(q(t,e,n,!0))}function R(t,e){var n=t.length,i=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(n);i[0]=i[n-1]=1,j(t,i,e,0,n-1);var o,r=[];for(o=0;o<n;o++)i[o]&&r.push(t[o]);return r}function j(t,e,n,i,o){var r,s,a,h=0;for(s=i+1;s<=o-1;s++)(a=q(t[s],t[i],t[o],!0))>h&&(r=s,h=a);h>n&&(e[r]=1,j(t,e,n,i,r),j(t,e,n,r,o))}function F(t,e){for(var n=[t[0]],i=1,o=0,r=t.length;i<r;i++)G(t[i],t[o])>e&&(n.push(t[i]),o=i);return o<r-1&&n.push(t[r-1]),n}function V(t,e,n,i,o){var r,s,a,h=i?Ki:W(t,n),u=W(e,n);for(Ki=u;!0;){if(!(h|u))return[t,e];if(h&u)return!1;a=W(s=H(t,e,r=h||u,n,o),n),r===h?(t=s,h=a):(e=s,u=a)}}function H(t,e,n,i,o){var r,s,a=e.x-t.x,h=e.y-t.y,u=i.min,l=i.max;return 8&n?(r=t.x+a*(l.y-t.y)/h,s=l.y):4&n?(r=t.x+a*(u.y-t.y)/h,s=u.y):2&n?(r=l.x,s=t.y+h*(l.x-t.x)/a):1&n&&(r=u.x,s=t.y+h*(u.x-t.x)/a),new x(r,s,o)}function W(t,e){var n=0;return t.x<e.min.x?n|=1:t.x>e.max.x&&(n|=2),t.y<e.min.y?n|=4:t.y>e.max.y&&(n|=8),n}function G(t,e){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i}function q(t,e,n,i){var o,r=e.x,s=e.y,a=n.x-r,h=n.y-s,u=a*a+h*h;return u>0&&((o=((t.x-r)*a+(t.y-s)*h)/u)>1?(r=n.x,s=n.y):o>0&&(r+=a*o,s+=h*o)),a=t.x-r,h=t.y-s,i?a*a+h*h:new x(r,s)}function U(t){return!ri(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]}function K(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),U(t)}function X(t,e,n,i){return"touchstart"===e?$(t,n,i):"touchmove"===e?nt(t,n,i):"touchend"===e&&it(t,n,i),this}function Y(t,e,n){var i=t["_leaflet_"+e+n];return"touchstart"===e?t.removeEventListener(Ji,i,!1):"touchmove"===e?t.removeEventListener(Qi,i,!1):"touchend"===e&&(t.removeEventListener(to,i,!1),t.removeEventListener(eo,i,!1)),this}function $(t,e,n){var i=a(function(t){if("mouse"!==t.pointerType&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE){if(!(no.indexOf(t.target.tagName)<0))return;ft(t)}et(t,e)});t["_leaflet_touchstart"+n]=i,t.addEventListener(Ji,i,!1),oo||(document.documentElement.addEventListener(Ji,J,!0),document.documentElement.addEventListener(Qi,Q,!0),document.documentElement.addEventListener(to,tt,!0),document.documentElement.addEventListener(eo,tt,!0),oo=!0)}function J(t){io[t.pointerId]=t,ro++}function Q(t){io[t.pointerId]&&(io[t.pointerId]=t)}function tt(t){delete io[t.pointerId],ro--}function et(t,e){t.touches=[];for(var n in io)t.touches.push(io[n]);t.changedTouches=[t],e(t)}function nt(t,e,n){var i=function(t){(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons)&&et(t,e)};t["_leaflet_touchmove"+n]=i,t.addEventListener(Qi,i,!1)}function it(t,e,n){var i=function(t){et(t,e)};t["_leaflet_touchend"+n]=i,t.addEventListener(to,i,!1),t.addEventListener(eo,i,!1)}function ot(t,e,n){function i(t){var e;if(ji){if(!bi||"mouse"===t.pointerType)return;e=ro}else e=t.touches.length;if(!(e>1)){var n=Date.now(),i=n-(r||n);s=t.touches?t.touches[0]:t,a=i>0&&i<=h,r=n}}function o(t){if(a&&!s.cancelBubble){if(ji){if(!bi||"mouse"===t.pointerType)return;var n,i,o={};for(i in s)n=s[i],o[i]=n&&n.bind?n.bind(s):n;s=o}s.type="dblclick",e(s),r=null}}var r,s,a=!1,h=250;return t[ho+so+n]=i,t[ho+ao+n]=o,t[ho+"dblclick"+n]=e,t.addEventListener(so,i,!1),t.addEventListener(ao,o,!1),t.addEventListener("dblclick",e,!1),this}function rt(t,e){var n=t[ho+so+e],i=t[ho+ao+e],o=t[ho+"dblclick"+e];return t.removeEventListener(so,n,!1),t.removeEventListener(ao,i,!1),bi||t.removeEventListener("dblclick",o,!1),this}function st(t,e,n,i){if("object"==typeof e)for(var o in e)ht(t,o,e[o],n);else for(var r=0,s=(e=p(e)).length;r<s;r++)ht(t,e[r],n,i);return this}function at(t,e,n,i){if("object"==typeof e)for(var o in e)ut(t,o,e[o],n);else if(e)for(var r=0,s=(e=p(e)).length;r<s;r++)ut(t,e[r],n,i);else{for(var a in t[uo])ut(t,a,t[uo][a]);delete t[uo]}return this}function ht(t,e,n,i){var o=e+h(n)+(i?"_"+h(i):"");if(t[uo]&&t[uo][o])return this;var r=function(e){return n.call(i||t,e||window.event)},s=r;ji&&0===e.indexOf("touch")?X(t,e,r,o):!Fi||"dblclick"!==e||!ot||ji&&Ti?"addEventListener"in t?"mousewheel"===e?t.addEventListener("onwheel"in t?"wheel":"mousewheel",r,!1):"mouseenter"===e||"mouseleave"===e?(r=function(e){e=e||window.event,yt(t,e)&&s(e)},t.addEventListener("mouseenter"===e?"mouseover":"mouseout",r,!1)):("click"===e&&Pi&&(r=function(t){wt(t,s)}),t.addEventListener(e,r,!1)):"attachEvent"in t&&t.attachEvent("on"+e,r):ot(t,r,o),t[uo]=t[uo]||{},t[uo][o]=r}function ut(t,e,n,i){var o=e+h(n)+(i?"_"+h(i):""),r=t[uo]&&t[uo][o];if(!r)return this;ji&&0===e.indexOf("touch")?Y(t,e,o):Fi&&"dblclick"===e&&rt?rt(t,o):"removeEventListener"in t?"mousewheel"===e?t.removeEventListener("onwheel"in t?"wheel":"mousewheel",r,!1):t.removeEventListener("mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,r,!1):"detachEvent"in t&&t.detachEvent("on"+e,r),t[uo][o]=null}function lt(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,vt(t),this}function ct(t){return ht(t,"mousewheel",lt),this}function dt(t){return st(t,"mousedown touchstart dblclick",lt),ht(t,"click",mt),this}function ft(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function pt(t){return ft(t),lt(t),this}function _t(t,e){if(!e)return new x(t.clientX,t.clientY);var n=e.getBoundingClientRect();return new x(t.clientX-n.left-e.clientLeft,t.clientY-n.top-e.clientTop)}function gt(t){return bi?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/lo:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}function mt(t){co[t.type]=!0}function vt(t){var e=co[t.type];return co[t.type]=!1,e}function yt(t,e){var n=e.relatedTarget;if(!n)return!0;try{for(;n&&n!==t;)n=n.parentNode}catch(t){return!1}return n!==t}function wt(t,e){var n=t.timeStamp||t.originalEvent&&t.originalEvent.timeStamp,i=Xi&&n-Xi;i&&i>100&&i<500||t.target._simulatedClick&&!t._simulated?pt(t):(Xi=n,e(t))}function xt(t,e,n,i){if(ri(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=e,this._c=n,this._d=i}function Lt(t,e,n,i){return new xt(t,e,n,i)}function bt(t){return"string"==typeof t?document.getElementById(t):t}function Mt(t,e){var n=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!n||"auto"===n)&&document.defaultView){var i=document.defaultView.getComputedStyle(t,null);n=i?i[e]:null}return"auto"===n?null:n}function Pt(t,e,n){var i=document.createElement(t);return i.className=e||"",n&&n.appendChild(i),i}function kt(t){var e=t.parentNode;e&&e.removeChild(t)}function Et(t){var e=t.parentNode;e.lastChild!==t&&e.appendChild(t)}function Tt(t){var e=t.parentNode;e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function At(t,e){if(void 0!==t.classList)return t.classList.contains(e);var n=Dt(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)}function Ct(t,e){if(void 0!==t.classList)for(var n=p(e),i=0,o=n.length;i<o;i++)t.classList.add(n[i]);else if(!At(t,e)){var r=Dt(t);zt(t,(r?r+" ":"")+e)}}function St(t,e){void 0!==t.classList?t.classList.remove(e):zt(t,f((" "+Dt(t)+" ").replace(" "+e+" "," ")))}function zt(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e}function Dt(t){return void 0===t.className.baseVal?t.className:t.className.baseVal}function Bt(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&It(t,e)}function It(t,e){var n=!1,i="DXImageTransform.Microsoft.Alpha";try{n=t.filters.item(i)}catch(t){if(1===e)return}e=Math.round(100*e),n?(n.Enabled=100!==e,n.Opacity=e):t.style.filter+=" progid:"+i+"(opacity="+e+")"}function Nt(t){for(var e=document.documentElement.style,n=0;n<t.length;n++)if(t[n]in e)return t[n];return!1}function Ot(t,e,n){var i=e||new x(0,0);t.style[vo]=(Bi?"translate("+i.x+"px,"+i.y+"px)":"translate3d("+i.x+"px,"+i.y+"px,0)")+(n?" scale("+n+")":"")}function Zt(t,e){t._leaflet_pos=e,Oi?Ot(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function Rt(t){return t._leaflet_pos||new x(0,0)}function jt(){st(window,"dragstart",ft)}function Ft(){at(window,"dragstart",ft)}function Vt(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(Ht(),Lo=t,bo=t.style.outline,t.style.outline="none",st(window,"keydown",Ht))}function Ht(){Lo&&(Lo.style.outline=bo,Lo=void 0,bo=void 0,at(window,"keydown",Ht))}function Wt(t,e){return new qo(t,e)}function Gt(t,e,n){var i,o,r,s,a,h,u,l,c,d=[1,4,2,8];for(o=0,u=t.length;o<u;o++)t[o]._code=W(t[o],e);for(s=0;s<4;s++){for(l=d[s],i=[],o=0,r=(u=t.length)-1;o<u;r=o++)a=t[o],h=t[r],a._code&l?h._code&l||((c=H(h,a,l,e,n))._code=W(c,e),i.push(c)):(h._code&l&&((c=H(h,a,l,e,n))._code=W(c,e),i.push(c)),i.push(a));t=i}return t}function qt(t,e){var n=t.x/e.x,i=t.y/e.y;if(n<=i)var o=n,r=0,s=n,a=(t.y-n*e.y)/2;else var o=i,r=(t.x-i*e.x)/2,s=i,a=0;return new xt(o,r,s,a)}function Ut(t,e){e=e||10;var n=Math.max(t.y,t.x),i=Math.log(n/(1*e))/Math.log(2);return Math.round(i)}function Kt(t){var e={};return t.inqueue_on=function(n,i,o){var r=e[n];r||((r={}).handlers=[],r.fn=function(t){for(var i=e[n]||{handlers:[]},o=i.handlers.length-1;o>=0;o--){var r=i.handlers[o];if(!0===r.call(r._context||this,t))break}},e[n]=r,t.on(n,r.fn)),i._context=o,r.handlers.push(i)},t.inqueue_off=function(n,i){var o=e[n];o&&(o.handlers=ti.without(o.handlers,i),o.handlers.length||(t.off(n,o.fn),delete e[n]))},t}function Xt(t){if(t){var e=qt({x:rr._container.offsetWidth,y:rr._container.offsetHeight},t);rr.options.crs=ti.extend({},or,{transformation:e}),rr.setMaxBounds([[-t.y,-t.x],[2*t.y,2*t.x]]),rr.setMaxZoom(Ut(t));var n=E([[0,0],[t.y,t.x]]);return ti.isUndefined(rr.getZoom())&&rr.fitBounds(n),n}}function Yt(t,e,n){n=n||sr;var i=ar[t]&&ar[t][n];if(!i)return"Missing "+n+" translation: "+t;if(e)for(var o in e)i=i.replace("{"+o+"}",e[o]);return i}function $t(){return ur||(ur=document.createElement("div"),ur.style="visibility: hidden; position: absolute; top:0; left:0;",ur=document.body.appendChild(ur))}function Jt(t){if(!t||t.length<7)return r.left(Yt("invalid_svg_content"));var e=(new DOMParser).parseFromString(t,"image/svg+xml").documentElement;if(!e||!e.getAttribute||!C(e.getAttribute("xmlns"),"http://www.w3.org/2000/svg"))return r.left(Yt("invalid_svg_content"));if(!e.height||!e.width)return r.left(Yt("no_svg_size"));var n=null;if(e.viewBox.baseVal&&0!=e.viewBox.baseVal.width){var i=e.viewBox.baseVal;n=[i.x,i.y,i.width,i.height]}var o=(new XMLSerializer).serializeToString(e),s="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(o)));if(!n&&(0==e.width.baseVal.value||0==e.height.baseVal.value)){var a=document.importNode(e,!0),h=(a=$t().appendChild(a)).getBBox();n=[0,0,h.x+h.width,h.y+h.height],$t().removeChild(a)}var u=0,l=0;return n&&(u=n[2],l=n[3]),0!=e.width.baseVal.value&&(u=e.width.baseVal.value),0!=e.height.baseVal.value&&(l=e.height.baseVal.value),r.right({svg_document:e,raw_svg:o,width:u,height:l,data_uri:s})}function Qt(t,e){return function(n){e("");var i=n.target.files[0];if(i)if("image/svg+xml"!==i.type)e(Yt("invalid_svg_type",{type:i.type}));else{var o=new FileReader;o.onloadend=function(n){Jt(o.result).fold(e,function(e){t(di,{raw_svg:e.raw_svg,url:e.data_uri,size_m:{x:Math.round(e.width),y:Math.round(e.height)},size_px:{x:e.width,y:e.height}})})},o.readAsText(i)}}}function te(t){return Wi?new fr(t):null}function ee(t){return Gi||qi?new mr(t):null}function ne(){}function ie(){return[]}function oe(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function re(t,e,n,i,o,r){for(var s,a=0,h=e.length,u=r.length;a<u;++a)(s=e[a])?(s.__data__=r[a],i[a]=s):n[a]=new oe(t,r[a]);for(;a<h;++a)(s=e[a])&&(o[a]=s)}function se(t,e,n,i,o,r,s){var a,h,u,l={},c=e.length,d=r.length,f=new Array(c);for(a=0;a<c;++a)(h=e[a])&&(f[a]=u=Cr+s.call(h,h.__data__,a,e),u in l?o[a]=h:l[u]=h);for(a=0;a<d;++a)(h=l[u=Cr+s.call(t,r[a],a,r)])?(i[a]=h,h.__data__=r[a],l[u]=null):n[a]=new oe(t,r[a]);for(a=0;a<c;++a)(h=e[a])&&l[f[a]]===h&&(o[a]=h)}function ae(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function he(t){return function(){this.removeAttribute(t)}}function ue(t){return function(){this.removeAttributeNS(t.space,t.local)}}function le(t,e){return function(){this.setAttribute(t,e)}}function ce(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function de(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function fe(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function pe(t){return function(){this.style.removeProperty(t)}}function _e(t,e,n){return function(){this.style.setProperty(t,e,n)}}function ge(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function me(t,e){return t.style.getPropertyValue(e)||qr(t).getComputedStyle(t,null).getPropertyValue(e)}function ve(t){return function(){delete this[t]}}function ye(t,e){return function(){this[t]=e}}function we(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function xe(t){return t.trim().split(/^|\s+/)}function Le(t){return t.classList||new be(t)}function be(t){this._node=t,this._names=xe(t.getAttribute("class")||"")}function Me(t,e){for(var n=Le(t),i=-1,o=e.length;++i<o;)n.add(e[i])}function Pe(t,e){for(var n=Le(t),i=-1,o=e.length;++i<o;)n.remove(e[i])}function ke(t){return function(){Me(this,t)}}function Ee(t){return function(){Pe(this,t)}}function Te(t,e){return function(){(e.apply(this,arguments)?Me:Pe)(this,t)}}function Ae(){this.textContent=""}function Ce(t){return function(){this.textContent=t}}function Se(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function ze(){this.innerHTML=""}function De(t){return function(){this.innerHTML=t}}function Be(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Ie(){this.nextSibling&&this.parentNode.appendChild(this)}function Ne(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Oe(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Vr&&e.documentElement.namespaceURI===Vr?e.createElement(t):e.createElementNS(n,t)}}function Ze(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Re(){return null}function je(){var t=this.parentNode;t&&t.removeChild(this)}function Fe(t,e,n){return t=Ve(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function Ve(t,e,n){return function(i){var o=ss;ss=i;try{t.call(this,this.__data__,e,n)}finally{ss=o}}}function He(t){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}function We(t){return function(){var e=this.__on;if(e){for(var n,i=0,o=-1,r=e.length;i<r;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++o]=n:this.removeEventListener(n.type,n.listener,n.capture);++o?e.length=o:delete this.__on}}}function Ge(t,e,n){var i=rs.hasOwnProperty(t.type)?Fe:Ve;return function(o,r,s){var a,h=this.__on,u=i(e,r,s);if(h)for(var l=0,c=h.length;l<c;++l)if((a=h[l]).type===t.type&&a.name===t.name)return this.removeEventListener(a.type,a.listener,a.capture),this.addEventListener(a.type,a.listener=u,a.capture=n),void(a.value=e);this.addEventListener(t.type,u,n),a={type:t.type,name:t.name,value:e,listener:u,capture:n},h?h.push(a):this.__on=[a]}}function qe(t,e,n){var i=qr(t),o=i.CustomEvent;"function"==typeof o?o=new o(e,n):(o=i.document.createEvent("Event"),n?(o.initEvent(e,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(e,!1,!1)),t.dispatchEvent(o)}function Ue(t,e){return function(){return qe(this,t,e)}}function Ke(t,e){return function(){return qe(this,t,e.apply(this,arguments))}}function Xe(t,e){this._groups=t,this._parents=e}function Ye(){return new Xe([[document.documentElement]],us)}function $e(t){return function(e,n){return cs(t(e),n)}}function Je(t,e,n){var i=(e-t)/Math.max(0,n),o=Math.floor(Math.log(i)/Math.LN10),r=i/Math.pow(10,o);return o>=0?(r>=fs?10:r>=ps?5:r>=_s?2:1)*Math.pow(10,o):-Math.pow(10,-o)/(r>=fs?10:r>=ps?5:r>=_s?2:1)}function Qe(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),o=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),r=i/o;return r>=fs?o*=10:r>=ps?o*=5:r>=_s&&(o*=2),e<t?-o:o}function tn(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function en(){}function nn(t){var e;return t=(t+"").trim().toLowerCase(),(e=bs.exec(t))?(e=parseInt(e[1],16),new hn(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1)):(e=Ms.exec(t))?on(parseInt(e[1],16)):(e=Ps.exec(t))?new hn(e[1],e[2],e[3],1):(e=ks.exec(t))?new hn(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Es.exec(t))?rn(e[1],e[2],e[3],e[4]):(e=Ts.exec(t))?rn(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=As.exec(t))?un(e[1],e[2]/100,e[3]/100,1):(e=Cs.exec(t))?un(e[1],e[2]/100,e[3]/100,e[4]):Ss.hasOwnProperty(t)?on(Ss[t]):"transparent"===t?new hn(NaN,NaN,NaN,0):null}function on(t){return new hn(t>>16&255,t>>8&255,255&t,1)}function rn(t,e,n,i){return i<=0&&(t=e=n=NaN),new hn(t,e,n,i)}function sn(t){return t instanceof en||(t=nn(t)),t?(t=t.rgb(),new hn(t.r,t.g,t.b,t.opacity)):new hn}function an(t,e,n,i){return 1===arguments.length?sn(t):new hn(t,e,n,null==i?1:i)}function hn(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function un(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new dn(t,e,n,i)}function ln(t){if(t instanceof dn)return new dn(t.h,t.s,t.l,t.opacity);if(t instanceof en||(t=nn(t)),!t)return new dn;if(t instanceof dn)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,o=Math.min(e,n,i),r=Math.max(e,n,i),s=NaN,a=r-o,h=(r+o)/2;return a?(s=e===r?(n-i)/a+6*(n<i):n===r?(i-e)/a+2:(e-n)/a+4,a/=h<.5?r+o:2-r-o,s*=60):a=h>0&&h<1?0:s,new dn(s,a,h,t.opacity)}function cn(t,e,n,i){return 1===arguments.length?ln(t):new dn(t,e,n,null==i?1:i)}function dn(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function fn(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function pn(t){if(t instanceof gn)return new gn(t.l,t.a,t.b,t.opacity);if(t instanceof bn){var e=t.h*zs;return new gn(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}t instanceof hn||(t=sn(t));var n=wn(t.r),i=wn(t.g),o=wn(t.b),r=mn((.4124564*n+.3575761*i+.1804375*o)/Is),s=mn((.2126729*n+.7151522*i+.072175*o)/Ns);return new gn(116*s-16,500*(r-s),200*(s-mn((.0193339*n+.119192*i+.9503041*o)/Os)),t.opacity)}function _n(t,e,n,i){return 1===arguments.length?pn(t):new gn(t,e,n,null==i?1:i)}function gn(t,e,n,i){this.l=+t,this.a=+e,this.b=+n,this.opacity=+i}function mn(t){return t>Fs?Math.pow(t,1/3):t/js+Zs}function vn(t){return t>Rs?t*t*t:js*(t-Zs)}function yn(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function wn(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function xn(t){if(t instanceof bn)return new bn(t.h,t.c,t.l,t.opacity);t instanceof gn||(t=pn(t));var e=Math.atan2(t.b,t.a)*Ds;return new bn(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function Ln(t,e,n,i){return 1===arguments.length?xn(t):new bn(t,e,n,null==i?1:i)}function bn(t,e,n,i){this.h=+t,this.c=+e,this.l=+n,this.opacity=+i}function Mn(t){if(t instanceof kn)return new kn(t.h,t.s,t.l,t.opacity);t instanceof hn||(t=sn(t));var e=t.r/255,n=t.g/255,i=t.b/255,o=(Xs*i+Us*e-Ks*n)/(Xs+Us-Ks),r=i-o,s=(qs*(n-o)-Ws*r)/Gs,a=Math.sqrt(s*s+r*r)/(qs*o*(1-o)),h=a?Math.atan2(s,r)*Ds-120:NaN;return new kn(h<0?h+360:h,a,o,t.opacity)}function Pn(t,e,n,i){return 1===arguments.length?Mn(t):new kn(t,e,n,null==i?1:i)}function kn(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function En(t,e){return function(n){return t+n*e}}function Tn(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function An(t,e){var n=e-t;return n?En(t,n>180||n<-180?n-360*Math.round(n/360):n):Ys(isNaN(t)?e:t)}function Cn(t){return 1==(t=+t)?Sn:function(e,n){return n-e?Tn(e,n,t):Ys(isNaN(e)?n:e)}}function Sn(t,e){var n=e-t;return n?En(t,n):Ys(isNaN(t)?e:t)}function zn(t){return function(){return t}}function Dn(t){return function(e){return t(e)+""}}function Bn(t){return function e(n){function i(e,i){var o=t((e=Pn(e)).h,(i=Pn(i)).h),r=Sn(e.s,i.s),s=Sn(e.l,i.l),a=Sn(e.opacity,i.opacity);return function(t){return e.h=o(t),e.s=r(t),e.l=s(Math.pow(t,n)),e.opacity=a(t),e+""}}return n=+n,i.gamma=e,i}(1)}function In(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:ca(e)}function Nn(t){return function(e,n){var i=t(e=+e,n=+n);return function(t){return t<=e?0:t>=n?1:i(t)}}}function On(t){return function(e,n){var i=t(e=+e,n=+n);return function(t){return t<=0?e:t>=1?n:i(t)}}}function Zn(t,e,n,i){var o=t[0],r=t[1],s=e[0],a=e[1];return r<o?(o=n(r,o),s=i(a,s)):(o=n(o,r),s=i(s,a)),function(t){return s(o(t))}}function Rn(t,e,n,i){var o=Math.min(t.length,e.length)-1,r=new Array(o),s=new Array(o),a=-1;for(t[o]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<o;)r[a]=n(t[a],t[a+1]),s[a]=i(e[a],e[a+1]);return function(e){var n=ds(t,e,1,o)-1;return s[n](r[n](e))}}function jn(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp())}function Fn(t,e){function n(){return o=Math.min(a.length,h.length)>2?Rn:Zn,r=s=null,i}function i(e){return(r||(r=o(a,h,l?Nn(t):t,u)))(+e)}var o,r,s,a=fa,h=fa,u=ra,l=!1;return i.invert=function(t){return(s||(s=o(h,a,In,l?On(e):e)))(+t)},i.domain=function(t){return arguments.length?(a=ua.call(t,da),n()):a.slice()},i.range=function(t){return arguments.length?(h=la.call(t),n()):h.slice()},i.rangeRound=function(t){return h=la.call(t),u=sa,n()},i.clamp=function(t){return arguments.length?(l=!!t,n()):l},i.interpolate=function(t){return arguments.length?(u=t,n()):u},n()}function Vn(t){return new Hn(t)}function Hn(t){if(!(e=wa.exec(t)))throw new Error("invalid format: "+t);var e,n=e[1]||" ",i=e[2]||">",o=e[3]||"-",r=e[4]||"",s=!!e[5],a=e[6]&&+e[6],h=!!e[7],u=e[8]&&+e[8].slice(1),l=e[9]||"";"n"===l?(h=!0,l="g"):ya[l]||(l=""),(s||"0"===n&&"="===i)&&(s=!0,n="0",i="="),this.fill=n,this.align=i,this.sign=o,this.symbol=r,this.zero=s,this.width=a,this.comma=h,this.precision=u,this.type=l}function Wn(t){var e=t.domain;return t.ticks=function(t){var n=e();return gs(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){return Ca(e(),t,n)},t.nice=function(n){null==n&&(n=10);var i,o=e(),r=0,s=o.length-1,a=o[r],h=o[s];return h<a&&(i=a,a=h,h=i,i=r,r=s,s=i),i=Je(a,h,n),i>0?i=Je(a=Math.floor(a/i)*i,h=Math.ceil(h/i)*i,n):i<0&&(i=Je(a=Math.ceil(a*i)/i,h=Math.floor(h*i)/i,n)),i>0?(o[r]=Math.floor(a/i)*i,o[s]=Math.ceil(h/i)*i,e(o)):i<0&&(o[r]=Math.ceil(a*i)/i,o[s]=Math.floor(h*i)/i,e(o)),t},t}function Gn(){var t=Fn(In,ta);return t.copy=function(){return jn(t,Gn())},Wn(t)}function qn(t){return"translate("+(t+.5)+",0)"}function Un(t){return"translate(0,"+(t+.5)+")"}function Kn(t){return function(e){return+t(e)}}function Xn(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}function Yn(){return!this.__axis}function $n(t,e){function n(n){var d=null==o?e.ticks?e.ticks.apply(e,i):e.domain():o,f=null==r?e.tickFormat?e.tickFormat.apply(e,i):za:r,p=Math.max(s,0)+h,_=e.range(),g=+_[0]+.5,m=+_[_.length-1]+.5,v=(e.bandwidth?Xn:Kn)(e.copy()),y=n.selection?n.selection():n,w=y.selectAll(".domain").data([null]),x=y.selectAll(".tick").data(d,e).order(),L=x.exit(),b=x.enter().append("g").attr("class","tick"),M=x.select("line"),P=x.select("text");w=w.merge(w.enter().insert("path",".tick").attr("class","domain").attr("stroke","#000")),x=x.merge(b),M=M.merge(b.append("line").attr("stroke","#000").attr(l+"2",u*s)),P=P.merge(b.append("text").attr("fill","#000").attr(l,u*p).attr("dy",t===Da?"0em":t===Ia?"0.71em":"0.32em")),n!==y&&(w=w.transition(n),x=x.transition(n),M=M.transition(n),P=P.transition(n),L=L.transition(n).attr("opacity",Oa).attr("transform",function(t){return isFinite(t=v(t))?c(t):this.getAttribute("transform")}),b.attr("opacity",Oa).attr("transform",function(t){var e=this.parentNode.__axis;return c(e&&isFinite(e=e(t))?e:v(t))})),L.remove(),w.attr("d",t===Na||t==Ba?"M"+u*a+","+g+"H0.5V"+m+"H"+u*a:"M"+g+","+u*a+"V0.5H"+m+"V"+u*a),x.attr("opacity",1).attr("transform",function(t){return c(v(t))}),M.attr(l+"2",u*s),P.attr(l,u*p).text(f),y.filter(Yn).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Ba?"start":t===Na?"end":"middle"),y.each(function(){this.__axis=v})}var i=[],o=null,r=null,s=6,a=6,h=3,u=t===Da||t===Na?-1:1,l=t===Na||t===Ba?"x":"y",c=t===Da||t===Ia?qn:Un;return n.scale=function(t){return arguments.length?(e=t,n):e},n.ticks=function(){return i=Sa.call(arguments),n},n.tickArguments=function(t){return arguments.length?(i=null==t?[]:Sa.call(t),n):i.slice()},n.tickValues=function(t){return arguments.length?(o=null==t?null:Sa.call(t),n):o&&o.slice()},n.tickFormat=function(t){return arguments.length?(r=t,n):r},n.tickSize=function(t){return arguments.length?(s=a=+t,n):s},n.tickSizeInner=function(t){return arguments.length?(s=+t,n):s},n.tickSizeOuter=function(t){return arguments.length?(a=+t,n):a},n.tickPadding=function(t){return arguments.length?(h=+t,n):h},n}function Jn(t){return $n(Ia,t)}function Qn(t){return $n(Na,t)}var ti=function(){function t(t){function e(e,n,i,o,r,s){for(;r>=0&&r<s;r+=t){var a=o?o[r]:r;i=n(i,e[a],a,e)}return i}return function(n,i,o,r){i=y(i,r,4);var s=!k(n)&&v.keys(n),a=(s||n).length,h=t>0?0:a-1;return arguments.length<3&&(o=n[s?s[h]:h],h+=t),e(n,i,o,s,h,a)}}function e(t){return function(e,n,i){n=w(n,i);for(var o=P(e),r=t>0?0:o-1;r>=0&&r<o;r+=t)if(n(e[r],r,e))return r;return-1}}function n(t,e,n){return function(i,o,r){var s=0,a=P(i);if("number"==typeof r)t>0?s=r>=0?r:Math.max(r+a,s):a=r>=0?Math.min(r+1,a):r+a+1;else if(n&&r&&a)return r=n(i,o),i[r]===o?r:-1;if(o!==o)return r=e(l.call(i,s,a),v.isNaN),r>=0?r+s:-1;for(r=t>0?s:a-1;r>=0&&r<a;r+=t)if(i[r]===o)return r;return-1}}function i(t,e){var n=S.length,i=t.constructor,o=v.isFunction(i)&&i.prototype||a,r="constructor";for(v.has(t,r)&&!v.contains(e,r)&&e.push(r);n--;)(r=S[n])in t&&t[r]!==o[r]&&!v.contains(e,r)&&e.push(r)}var o=this,r=o._,s=Array.prototype,a=Object.prototype,h=Function.prototype,u=s.push,l=s.slice,c=a.toString,d=a.hasOwnProperty,f=Array.isArray,p=Object.keys,_=h.bind,g=Object.create,m=function(){},v=function(t){return t instanceof v?t:this instanceof v?void(this._wrapped=t):new v(t)};o._=v,v.VERSION="1.8.3";var y=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,o){return t.call(e,n,i,o)};case 4:return function(n,i,o,r){return t.call(e,n,i,o,r)}}return function(){return t.apply(e,arguments)}},w=function(t,e,n){return null==t?v.identity:v.isFunction(t)?y(t,e,n):v.isObject(t)?v.matcher(t):v.property(t)};v.iteratee=function(t,e){return w(t,e,1/0)};var x=function(t,e){return function(n){var i=arguments.length;if(i<2||null==n)return n;for(var o=1;o<i;o++)for(var r=arguments[o],s=t(r),a=s.length,h=0;h<a;h++){var u=s[h];e&&void 0!==n[u]||(n[u]=r[u])}return n}},L=function(t){if(!v.isObject(t))return{};if(g)return g(t);m.prototype=t;var e=new m;return m.prototype=null,e},b=function(t){return function(e){return null==e?void 0:e[t]}},M=Math.pow(2,53)-1,P=b("length"),k=function(t){var e=P(t);return"number"==typeof e&&e>=0&&e<=M};v.each=v.forEach=function(t,e,n){e=y(e,n);var i,o;if(k(t))for(i=0,o=t.length;i<o;i++)e(t[i],i,t);else{var r=v.keys(t);for(i=0,o=r.length;i<o;i++)e(t[r[i]],r[i],t)}return t},v.map=v.collect=function(t,e,n){e=w(e,n);for(var i=!k(t)&&v.keys(t),o=(i||t).length,r=Array(o),s=0;s<o;s++){var a=i?i[s]:s;r[s]=e(t[a],a,t)}return r},v.reduce=v.foldl=v.inject=t(1),v.reduceRight=v.foldr=t(-1),v.find=v.detect=function(t,e,n){var i;if(void 0!==(i=k(t)?v.findIndex(t,e,n):v.findKey(t,e,n))&&-1!==i)return t[i]},v.filter=v.select=function(t,e,n){var i=[];return e=w(e,n),v.each(t,function(t,n,o){e(t,n,o)&&i.push(t)}),i},v.reject=function(t,e,n){return v.filter(t,v.negate(w(e)),n)},v.every=v.all=function(t,e,n){e=w(e,n);for(var i=!k(t)&&v.keys(t),o=(i||t).length,r=0;r<o;r++){var s=i?i[r]:r;if(!e(t[s],s,t))return!1}return!0},v.some=v.any=function(t,e,n){e=w(e,n);for(var i=!k(t)&&v.keys(t),o=(i||t).length,r=0;r<o;r++){var s=i?i[r]:r;if(e(t[s],s,t))return!0}return!1},v.contains=v.includes=v.include=function(t,e,n,i){return k(t)||(t=v.values(t)),("number"!=typeof n||i)&&(n=0),v.indexOf(t,e,n)>=0},v.invoke=function(t,e){var n=l.call(arguments,2),i=v.isFunction(e);return v.map(t,function(t){var o=i?e:t[e];return null==o?o:o.apply(t,n)})},v.pluck=function(t,e){return v.map(t,v.property(e))},v.where=function(t,e){return v.filter(t,v.matcher(e))},v.findWhere=function(t,e){return v.find(t,v.matcher(e))},v.max=function(t,e,n){var i,o,r=-1/0,s=-1/0;if(null==e&&null!=t)for(var a=0,h=(t=k(t)?t:v.values(t)).length;a<h;a++)(i=t[a])>r&&(r=i);else e=w(e,n),v.each(t,function(t,n,i){((o=e(t,n,i))>s||o===-1/0&&r===-1/0)&&(r=t,s=o)});return r},v.min=function(t,e,n){var i,o,r=1/0,s=1/0;if(null==e&&null!=t)for(var a=0,h=(t=k(t)?t:v.values(t)).length;a<h;a++)(i=t[a])<r&&(r=i);else e=w(e,n),v.each(t,function(t,n,i){((o=e(t,n,i))<s||o===1/0&&r===1/0)&&(r=t,s=o)});return r},v.shuffle=function(t){for(var e,n=k(t)?t:v.values(t),i=n.length,o=Array(i),r=0;r<i;r++)(e=v.random(0,r))!==r&&(o[r]=o[e]),o[e]=n[r];return o},v.sample=function(t,e,n){return null==e||n?(k(t)||(t=v.values(t)),t[v.random(t.length-1)]):v.shuffle(t).slice(0,Math.max(0,e))},v.sortBy=function(t,e,n){return e=w(e,n),v.pluck(v.map(t,function(t,n,i){return{value:t,index:n,criteria:e(t,n,i)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(n<i||void 0===i)return-1}return t.index-e.index}),"value")};var E=function(t){return function(e,n,i){var o={};return n=w(n,i),v.each(e,function(i,r){var s=n(i,r,e);t(o,i,s)}),o}};v.groupBy=E(function(t,e,n){v.has(t,n)?t[n].push(e):t[n]=[e]}),v.indexBy=E(function(t,e,n){t[n]=e}),v.countBy=E(function(t,e,n){v.has(t,n)?t[n]++:t[n]=1}),v.toArray=function(t){return t?v.isArray(t)?l.call(t):k(t)?v.map(t,v.identity):v.values(t):[]},v.size=function(t){return null==t?0:k(t)?t.length:v.keys(t).length},v.partition=function(t,e,n){e=w(e,n);var i=[],o=[];return v.each(t,function(t,n,r){(e(t,n,r)?i:o).push(t)}),[i,o]},v.first=v.head=v.take=function(t,e,n){if(null!=t)return null==e||n?t[0]:v.initial(t,t.length-e)},v.initial=function(t,e,n){return l.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},v.last=function(t,e,n){if(null!=t)return null==e||n?t[t.length-1]:v.rest(t,Math.max(0,t.length-e))},v.rest=v.tail=v.drop=function(t,e,n){return l.call(t,null==e||n?1:e)},v.compact=function(t){return v.filter(t,v.identity)};var T=function(t,e,n,i){for(var o=[],r=0,s=i||0,a=P(t);s<a;s++){var h=t[s];if(k(h)&&(v.isArray(h)||v.isArguments(h))){e||(h=T(h,e,n));var u=0,l=h.length;for(o.length+=l;u<l;)o[r++]=h[u++]}else n||(o[r++]=h)}return o};v.flatten=function(t,e){return T(t,e,!1)},v.without=function(t){return v.difference(t,l.call(arguments,1))},v.uniq=v.unique=function(t,e,n,i){v.isBoolean(e)||(i=n,n=e,e=!1),null!=n&&(n=w(n,i));for(var o=[],r=[],s=0,a=P(t);s<a;s++){var h=t[s],u=n?n(h,s,t):h;e?(s&&r===u||o.push(h),r=u):n?v.contains(r,u)||(r.push(u),o.push(h)):v.contains(o,h)||o.push(h)}return o},v.union=function(){return v.uniq(T(arguments,!0,!0))},v.intersection=function(t){for(var e=[],n=arguments.length,i=0,o=P(t);i<o;i++){var r=t[i];if(!v.contains(e,r)){for(var s=1;s<n&&v.contains(arguments[s],r);s++);s===n&&e.push(r)}}return e},v.difference=function(t){var e=T(arguments,!0,!0,1);return v.filter(t,function(t){return!v.contains(e,t)})},v.zip=function(){return v.unzip(arguments)},v.unzip=function(t){for(var e=t&&v.max(t,P).length||0,n=Array(e),i=0;i<e;i++)n[i]=v.pluck(t,i);return n},v.object=function(t,e){for(var n={},i=0,o=P(t);i<o;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},v.findIndex=e(1),v.findLastIndex=e(-1),v.sortedIndex=function(t,e,n,i){for(var o=(n=w(n,i,1))(e),r=0,s=P(t);r<s;){var a=Math.floor((r+s)/2);n(t[a])<o?r=a+1:s=a}return r},v.indexOf=n(1,v.findIndex,v.sortedIndex),v.lastIndexOf=n(-1,v.findLastIndex),v.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||1;for(var i=Math.max(Math.ceil((e-t)/n),0),o=Array(i),r=0;r<i;r++,t+=n)o[r]=t;return o};var A=function(t,e,n,i,o){if(!(i instanceof e))return t.apply(n,o);var r=L(t.prototype),s=t.apply(r,o);return v.isObject(s)?s:r};v.bind=function(t,e){if(_&&t.bind===_)return _.apply(t,l.call(arguments,1));if(!v.isFunction(t))throw new TypeError("Bind must be called on a function");var n=l.call(arguments,2),i=function(){return A(t,i,e,this,n.concat(l.call(arguments)))};return i},v.partial=function(t){var e=l.call(arguments,1),n=function(){for(var i=0,o=e.length,r=Array(o),s=0;s<o;s++)r[s]=e[s]===v?arguments[i++]:e[s];for(;i<arguments.length;)r.push(arguments[i++]);return A(t,n,this,this,r)};return n},v.bindAll=function(t){var e,n,i=arguments.length;if(i<=1)throw new Error("bindAll must be passed function names");for(e=1;e<i;e++)t[n=arguments[e]]=v.bind(t[n],t);return t},v.memoize=function(t,e){var n=function(i){var o=n.cache,r=""+(e?e.apply(this,arguments):i);return v.has(o,r)||(o[r]=t.apply(this,arguments)),o[r]};return n.cache={},n},v.delay=function(t,e){var n=l.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},v.defer=v.partial(v.delay,v,1),v.throttle=function(t,e,n){var i,o,r,s=null,a=0;n||(n={});var h=function(){a=!1===n.leading?0:v.now(),s=null,r=t.apply(i,o),s||(i=o=null)};return function(){var u=v.now();a||!1!==n.leading||(a=u);var l=e-(u-a);return i=this,o=arguments,l<=0||l>e?(s&&(clearTimeout(s),s=null),a=u,r=t.apply(i,o),s||(i=o=null)):s||!1===n.trailing||(s=setTimeout(h,l)),r}},v.debounce=function(t,e,n){var i,o,r,s,a,h=function(){var u=v.now()-s;u<e&&u>=0?i=setTimeout(h,e-u):(i=null,n||(a=t.apply(r,o),i||(r=o=null)))};return function(){r=this,o=arguments,s=v.now();var u=n&&!i;return i||(i=setTimeout(h,e)),u&&(a=t.apply(r,o),r=o=null),a}},v.wrap=function(t,e){return v.partial(e,t)},v.negate=function(t){return function(){return!t.apply(this,arguments)}},v.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,i=t[e].apply(this,arguments);n--;)i=t[n].call(this,i);return i}},v.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},v.before=function(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}},v.once=v.partial(v.before,2);var C=!{toString:null}.propertyIsEnumerable("toString"),S=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];v.keys=function(t){if(!v.isObject(t))return[];if(p)return p(t);var e=[];for(var n in t)v.has(t,n)&&e.push(n);return C&&i(t,e),e},v.allKeys=function(t){if(!v.isObject(t))return[];var e=[];for(var n in t)e.push(n);return C&&i(t,e),e},v.values=function(t){for(var e=v.keys(t),n=e.length,i=Array(n),o=0;o<n;o++)i[o]=t[e[o]];return i},v.mapObject=function(t,e,n){e=w(e,n);for(var i,o=v.keys(t),r=o.length,s={},a=0;a<r;a++)s[i=o[a]]=e(t[i],i,t);return s},v.pairs=function(t){for(var e=v.keys(t),n=e.length,i=Array(n),o=0;o<n;o++)i[o]=[e[o],t[e[o]]];return i},v.invert=function(t){for(var e={},n=v.keys(t),i=0,o=n.length;i<o;i++)e[t[n[i]]]=n[i];return e},v.functions=v.methods=function(t){var e=[];for(var n in t)v.isFunction(t[n])&&e.push(n);return e.sort()},v.extend=x(v.allKeys),v.extendOwn=v.assign=x(v.keys),v.findKey=function(t,e,n){e=w(e,n);for(var i,o=v.keys(t),r=0,s=o.length;r<s;r++)if(i=o[r],e(t[i],i,t))return i},v.pick=function(t,e,n){var i,o,r={},s=t;if(null==s)return r;v.isFunction(e)?(o=v.allKeys(s),i=y(e,n)):(o=T(arguments,!1,!1,1),i=function(t,e,n){return e in n},s=Object(s));for(var a=0,h=o.length;a<h;a++){var u=o[a],l=s[u];i(l,u,s)&&(r[u]=l)}return r},v.omit=function(t,e,n){if(v.isFunction(e))e=v.negate(e);else{var i=v.map(T(arguments,!1,!1,1),String);e=function(t,e){return!v.contains(i,e)}}return v.pick(t,e,n)},v.defaults=x(v.allKeys,!0),v.create=function(t,e){var n=L(t);return e&&v.extendOwn(n,e),n},v.clone=function(t){return v.isObject(t)?v.isArray(t)?t.slice():v.extend({},t):t},v.tap=function(t,e){return e(t),t},v.isMatch=function(t,e){var n=v.keys(e),i=n.length;if(null==t)return!i;for(var o=Object(t),r=0;r<i;r++){var s=n[r];if(e[s]!==o[s]||!(s in o))return!1}return!0};var z=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof v&&(t=t._wrapped),e instanceof v&&(e=e._wrapped);var o=c.call(t);if(o!==c.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e}var r="[object Array]"===o;if(!r){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,a=e.constructor;if(s!==a&&!(v.isFunction(s)&&s instanceof s&&v.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}n=n||[],i=i||[];for(var h=n.length;h--;)if(n[h]===t)return i[h]===e;if(n.push(t),i.push(e),r){if((h=t.length)!==e.length)return!1;for(;h--;)if(!z(t[h],e[h],n,i))return!1}else{var u,l=v.keys(t);if(h=l.length,v.keys(e).length!==h)return!1;for(;h--;)if(u=l[h],!v.has(e,u)||!z(t[u],e[u],n,i))return!1}return n.pop(),i.pop(),!0};v.isEqual=function(t,e){return z(t,e)},v.isEmpty=function(t){return null==t||(k(t)&&(v.isArray(t)||v.isString(t)||v.isArguments(t))?0===t.length:0===v.keys(t).length)},v.isElement=function(t){return!(!t||1!==t.nodeType)},v.isArray=f||function(t){return"[object Array]"===c.call(t)},v.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},v.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){v["is"+t]=function(e){return c.call(e)==="[object "+t+"]"}}),v.isArguments(arguments)||(v.isArguments=function(t){return v.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(v.isFunction=function(t){return"function"==typeof t||!1}),v.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},v.isNaN=function(t){return v.isNumber(t)&&t!==+t},v.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===c.call(t)},v.isNull=function(t){return null===t},v.isUndefined=function(t){return void 0===t},v.has=function(t,e){return null!=t&&d.call(t,e)},v.noConflict=function(){return o._=r,this},v.identity=function(t){return t},v.constant=function(t){return function(){return t}},v.noop=function(){},v.property=b,v.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},v.matcher=v.matches=function(t){return t=v.extendOwn({},t),function(e){return v.isMatch(e,t)}},v.times=function(t,e,n){var i=Array(Math.max(0,t));e=y(e,n,1);for(var o=0;o<t;o++)i[o]=e(o);return i},v.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},v.now=Date.now||function(){return(new Date).getTime()};var D={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},B=v.invert(D),I=function(t){var e=function(e){return t[e]},n="(?:"+v.keys(t).join("|")+")",i=RegExp(n),o=RegExp(n,"g");return function(t){return t=null==t?"":""+t,i.test(t)?t.replace(o,e):t}};v.escape=I(D),v.unescape=I(B),v.result=function(t,e,n){var i=null==t?void 0:t[e];return void 0===i&&(i=n),v.isFunction(i)?i.call(t):i};var N=0;v.uniqueId=function(t){var e=++N+"";return t?t+e:e},v.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var O=/(.)^/,Z={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},R=/\\|'|\r|\n|\u2028|\u2029/g,j=function(t){return"\\"+Z[t]};v.template=function(t,e,n){!e&&n&&(e=n),e=v.defaults({},e,v.templateSettings);var i=RegExp([(e.escape||O).source,(e.interpolate||O).source,(e.evaluate||O).source].join("|")+"|$","g"),o=0,r="__p+='";t.replace(i,function(e,n,i,s,a){return r+=t.slice(o,a).replace(R,j),o=a+e.length,n?r+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?r+="'+\n((__t=("+i+"))==null?'':__t)+\n'":s&&(r+="';\n"+s+"\n__p+='"),e}),r+="';\n",e.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{var s=new Function(e.variable||"obj","_",r)}catch(t){throw t.source=r,t}var a=function(t){return s.call(this,t,v)},h=e.variable||"obj";return a.source="function("+h+"){\n"+r+"}",a},v.chain=function(t){var e=v(t);return e._chain=!0,e};var F=function(t,e){return t._chain?v(e).chain():e};return v.mixin=function(t){v.each(v.functions(t),function(e){var n=v[e]=t[e];v.prototype[e]=function(){var t=[this._wrapped];return u.apply(t,arguments),F(this,n.apply(v,t))}})},v.mixin(v),v.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=s[t];v.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],F(this,n)}}),v.each(["concat","join","slice"],function(t){var e=s[t];v.prototype[t]=function(){return F(this,e.apply(this._wrapped,arguments))}}),v.prototype.value=function(){return this._wrapped},v.prototype.valueOf=v.prototype.toJSON=v.prototype.value,v.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return v}),this}.call({})._,ei={pavilions:{},map:{drawMode:void 0,size_m:void 0},selectedPavilion:void 0,selectedBase:void 0,selectedOverlay:void 0,selectedStandsId:void 0,entities:{bases:{},overlays:{},stands:{},stand_types:{},equipments:{}},ui:{error:"",overlay:{types:{lines:1,rects:1,notes:1},feat:void 0,text:"Text label",edit:!1},stands:{type:1,sel:void 0,edit:!1,size:{x:10,y:10}}}};ti.partial(i,"bases"),ti.partial(i,"overlays"),ti.partial(i,"stands");r.right=function(t){return r(void 0,t)},r.left=function(t){return r(t)};var ni=function(){function t(e,n,i,o){if(ti.isArray(n)||(n=n.split(".")),ti.isUndefined(e)&&(e={}),1==n.length)e=ti.clone(e),"extend"==o?e[n[0]]=ti.extend({},e[n[0]],i):"set"==o?e[n[0]]=i:delete e[n[0]];else{var r=n[0],s=e[r];s=t(s,n.slice(1),i,o),(e=ti.clone(e))[r]=s}return e}var e={};return e.set=function(e,n,i){return t(e,n,i,"set")},e.extend=function(e,n,i){return t(e,n,i,"extend")},e.remove=function(e,n){return t(e,n,null,"remove")},e.get=function(t,e){ti.isArray(e)||(e=e.split("."));for(var n in e){var i=e[n];if(ti.isUndefined(t))break;t=t[i]}return t},e}();Object.freeze=function(t){return t};var ii=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}(),oi=0,ri=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},si=0,ai=window.requestAnimationFrame||m("RequestAnimationFrame")||v,hi=window.cancelAnimationFrame||m("CancelAnimationFrame")||m("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};x.prototype={clone:function(){return new x(this.x,this.y)},add:function(t){return this.clone()._add(b(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(b(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new x(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new x(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},distanceTo:function(t){var e=(t=b(t)).x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},equals:function(t){return(t=b(t)).x===this.x&&t.y===this.y},contains:function(t){return t=b(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+d(this.x)+", "+d(this.y)+")"}},M.prototype={extend:function(t){return t=b(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new x((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new x(this.min.x,this.max.y)},getTopRight:function(){return new x(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,n;return t="number"==typeof t[0]||t instanceof x?b(t):P(t),t instanceof M?(e=t.min,n=t.max):e=n=t,e.x>=this.min.x&&n.x<=this.max.x&&e.y>=this.min.y&&n.y<=this.max.y},intersects:function(t){t=P(t);var e=this.min,n=this.max,i=t.min,o=t.max,r=o.x>=e.x&&i.x<=n.x,s=o.y>=e.y&&i.y<=n.y;return r&&s},overlaps:function(t){t=P(t);var e=this.min,n=this.max,i=t.min,o=t.max,r=o.x>e.x&&i.x<n.x,s=o.y>e.y&&i.y<n.y;return r&&s},isValid:function(){return!(!this.min||!this.max)}},k.prototype={extend:function(t){var e,n,i=this._southWest,o=this._northEast;if(t instanceof T)e=t,n=t;else{if(!(t instanceof k))return t?this.extend(A(t)||E(t)):this;if(e=t._southWest,n=t._northEast,!e||!n)return this}return i||o?(i.lat=Math.min(e.lat,i.lat),i.lng=Math.min(e.lng,i.lng),o.lat=Math.max(n.lat,o.lat),o.lng=Math.max(n.lng,o.lng)):(this._southWest=new T(e.lat,e.lng),this._northEast=new T(n.lat,n.lng)),this},pad:function(t){var e=this._southWest,n=this._northEast,i=Math.abs(e.lat-n.lat)*t,o=Math.abs(e.lng-n.lng)*t;return new k(new T(e.lat-i,e.lng-o),new T(n.lat+i,n.lng+o))},getCenter:function(){return new T((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new T(this.getNorth(),this.getWest())},getSouthEast:function(){return new T(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof T||"lat"in t?A(t):E(t);var e,n,i=this._southWest,o=this._northEast;return t instanceof k?(e=t.getSouthWest(),n=t.getNorthEast()):e=n=t,e.lat>=i.lat&&n.lat<=o.lat&&e.lng>=i.lng&&n.lng<=o.lng},intersects:function(t){t=E(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),o=t.getNorthEast(),r=o.lat>=e.lat&&i.lat<=n.lat,s=o.lng>=e.lng&&i.lng<=n.lng;return r&&s},overlaps:function(t){t=E(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),o=t.getNorthEast(),r=o.lat>e.lat&&i.lat<n.lat,s=o.lng>e.lng&&i.lng<n.lng;return r&&s},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return!!t&&(t=E(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e))},isValid:function(){return!(!this._southWest||!this._northEast)}};var ui={latLngToPoint:function(t,e){var n=this.projection.project(t),i=this.scale(e);return this.transformation._transform(n,i)},pointToLatLng:function(t,e){var n=this.scale(e),i=this.transformation.untransform(t,n);return this.projection.unproject(i)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,n=this.scale(t);return new M(this.transformation.transform(e.min,n),this.transformation.transform(e.max,n))},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?l(t.lng,this.wrapLng,!0):t.lng;return new T(this.wrapLat?l(t.lat,this.wrapLat,!0):t.lat,e,t.alt)},wrapLatLngBounds:function(t){var e=t.getCenter(),n=this.wrapLatLng(e),i=e.lat-n.lat,o=e.lng-n.lng;if(0===i&&0===o)return t;var r=t.getSouthWest(),s=t.getNorthEast();return new k(new T(r.lat-i,r.lng-o),new T(s.lat-i,s.lng-o))}},li=s({},ui,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var n=Math.PI/180,i=t.lat*n,o=e.lat*n,r=Math.sin(i)*Math.sin(o)+Math.cos(i)*Math.cos(o)*Math.cos((e.lng-t.lng)*n);return this.R*Math.acos(Math.min(r,1))}});T.prototype={equals:function(t,e){return!!t&&(t=A(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===e?1e-9:e))},toString:function(t){return"LatLng("+d(this.lat,t)+", "+d(this.lng,t)+")"},distanceTo:function(t){return li.distance(this,A(t))},wrap:function(){return li.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return E([this.lat-e,this.lng-n],[this.lat+e,this.lng+n])},clone:function(){return new T(this.lat,this.lng,this.alt)}};var ci="UNSELECT_ALL",di="BASE_LAYER_SET",fi="BASE_LAYER_SAVED",pi="BASES_LOADED",_i="BASE_DISTANCE_SET",gi="BASE_DISTANCE_LENGTH_SET",mi="DRAWING_MODE_SET",vi=function(t,e){switch(e.type){case mi:var n=e.payload;return ni.set(t,"map.drawMode",n);case ci:return t=ni.remove(t,"ui.overlay.feat"),t=ni.remove(t,"ui.stands.sel")}return t},yi=function(t,e){switch(e.type){case pi:return ni.set(t,"entities.bases",e.payload);case di:s=e.payload;return s=ni.extend(s,"grid",{topLeft:[0,0],bottomRight:[s.size_m.x,s.size_m.y]}),t=ni.extend(t,"selectedBase",s),ni.set(t,"map.size_m",s.size_m);case gi:var n=e.payload,i=n/t.selectedBase.distance.length_m,o=t.selectedBase.size_m;return o={x:o.x*i,y:o.y*i},t=ni.set(t,"map.size_m",o),t=ni.set(t,"selectedBase.size_m",o),ni.set(t,"selectedBase.distance.length_m",n);case _i:var r=e.payload;return ni.set(t,"selectedBase.distance",r);case fi:var s=e.payload;return t.pavilions[s.id]?(t=ni.set(t,"entities.bases."+s.id,s)).selectedPavilion&&s.id==t.selectedPavilion.id&&(t=ni.set(t,"selectedBase",s)):t=ni.remove(t,"entities.bases."+s.id),t}return t},wi=document.documentElement.style,xi="ActiveXObject"in window,Li=xi&&!document.addEventListener,bi="msLaunchUri"in navigator&&!("documentMode"in document),Mi=B("webkit"),Pi=B("android"),ki=B("android 2")||B("android 3"),Ei=!!window.opera,Ti=B("chrome"),Ai=B("gecko")&&!Mi&&!Ei&&!xi,Ci=!Ti&&B("safari"),Si=B("phantom"),zi="OTransition"in wi,Di=0===navigator.platform.indexOf("Win"),Bi=xi&&"transition"in wi,Ii="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ki,Ni="MozPerspective"in wi,Oi=!window.L_DISABLE_3D&&(Bi||Ii||Ni)&&!zi&&!Si,Zi="undefined"!=typeof orientation||B("mobile"),Ri=!window.PointerEvent&&window.MSPointerEvent,ji=!(!window.PointerEvent&&!Ri),Fi=!1,Vi=Zi&&Ei,Hi=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Wi=function(){return!!document.createElement("canvas").getContext}(),Gi=!(!document.createElementNS||!z("svg").createSVGRect),qi=!Gi&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(t){return!1}}();I.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},n=e.__super__=this.prototype,i=ii(n);i.constructor=e,e.prototype=i;for(var o in this)this.hasOwnProperty(o)&&"prototype"!==o&&"__super__"!==o&&(e[o]=this[o]);return t.statics&&(s(e,t.statics),delete t.statics),t.includes&&(N(t.includes),s.apply(null,[i].concat(t.includes)),delete t.includes),i.options&&(t.options=s(ii(i.options),t.options)),s(i,t),i._initHooks=[],i.callInitHooks=function(){if(!this._initHooksCalled){n.callInitHooks&&n.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=i._initHooks.length;t<e;t++)i._initHooks[t].call(this)}},e},I.include=function(t){return s(this.prototype,t),this},I.mergeOptions=function(t){return s(this.prototype.options,t),this},I.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),n="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n),this};var Ui={on:function(t,e,n){if("object"==typeof t)for(var i in t)this._on(i,t[i],e);else for(var o=0,r=(t=p(t)).length;o<r;o++)this._on(t[o],e,n);return this},off:function(t,e,n){if(t)if("object"==typeof t)for(var i in t)this._off(i,t[i],e);else for(var o=0,r=(t=p(t)).length;o<r;o++)this._off(t[o],e,n);else delete this._events;return this},_on:function(t,e,n){this._events=this._events||{};var i=this._events[t];i||(i=[],this._events[t]=i),n===this&&(n=void 0);for(var o={fn:e,ctx:n},r=i,s=0,a=r.length;s<a;s++)if(r[s].fn===e&&r[s].ctx===n)return;r.push(o)},_off:function(t,e,n){var i,o,r;if(this._events&&(i=this._events[t]))if(e){if(n===this&&(n=void 0),i)for(o=0,r=i.length;o<r;o++){var s=i[o];if(s.ctx===n&&s.fn===e)return s.fn=c,this._firingCount&&(this._events[t]=i=i.slice()),void i.splice(o,1)}}else{for(o=0,r=i.length;o<r;o++)i[o].fn=c;delete this._events[t]}},fire:function(t,e,n){if(!this.listens(t,n))return this;var i=s({},e,{type:t,target:this});if(this._events){var o=this._events[t];if(o){this._firingCount=this._firingCount+1||1;for(var r=0,a=o.length;r<a;r++){var h=o[r];h.fn.call(h.ctx||this,i)}this._firingCount--}}return n&&this._propagateEvent(i),this},listens:function(t,e){var n=this._events&&this._events[t];if(n&&n.length)return!0;if(e)for(var i in this._eventParents)if(this._eventParents[i].listens(t,e))return!0;return!1},once:function(t,e,n){if("object"==typeof t){for(var i in t)this.once(i,t[i],e);return this}var o=a(function(){this.off(t,e,n).off(t,o,n)},this);return this.on(t,e,n).on(t,o,n)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[h(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[h(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,s({layer:t.target},t),!0)}};Ui.addEventListener=Ui.on,Ui.removeEventListener=Ui.clearAllEventListeners=Ui.off,Ui.addOneTimeEventListener=Ui.once,Ui.fireEvent=Ui.fire,Ui.hasEventListeners=Ui.listens;var Ki,Xi,Yi=I.extend(Ui),$i=I.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}}),Ji=Ri?"MSPointerDown":"pointerdown",Qi=Ri?"MSPointerMove":"pointermove",to=Ri?"MSPointerUp":"pointerup",eo=Ri?"MSPointerCancel":"pointercancel",no=["INPUT","SELECT","OPTION"],io={},oo=!1,ro=0,so=Ri?"MSPointerDown":ji?"pointerdown":"touchstart",ao=Ri?"MSPointerUp":ji?"pointerup":"touchend",ho="_leaflet_",uo="_leaflet_events",lo=Di&&Ti?2*window.devicePixelRatio:Ai?window.devicePixelRatio:1,co={},fo={R:6378137,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,t.lat),-n),o=Math.sin(i*e);return new x(this.R*t.lng*e,this.R*Math.log((1+o)/(1-o))/2)},unproject:function(t){var e=180/Math.PI;return new T((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:function(){var t=6378137*Math.PI;return new M([-t,-t],[t,t])}()};xt.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new x((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};var po,_o,go,mo=s({},li,{code:"EPSG:3857",projection:fo,transformation:function(){var t=.5/(Math.PI*fo.R);return Lt(t,.5,-t,.5)}()}),vo=(s({},mo,{code:"EPSG:900913"}),Nt(["transform","WebkitTransform","OTransform","MozTransform","msTransform"])),yo=Nt(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),wo="webkitTransition"===yo||"OTransition"===yo?yo+"End":"transitionend";if("onselectstart"in document)po=function(){st(window,"selectstart",ft)},_o=function(){at(window,"selectstart",ft)};else{var xo=Nt(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);po=function(){if(xo){var t=document.documentElement.style;go=t[xo],t[xo]="none"}},_o=function(){xo&&(document.documentElement.style[xo]=go,go=void 0)}}var Lo,bo,Mo=Yi.extend({run:function(t,e,n,i){this.stop(),this._el=t,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(i||.5,.2),this._startPos=Rt(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=y(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,n=1e3*this._duration;e<n?this._runFrame(this._easeOut(e/n),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var n=this._startPos.add(this._offset.multiplyBy(t));e&&n._round(),Zt(this._el,n),this.fire("step")},_complete:function(){w(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),Po=Yi.extend({options:{crs:mo,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=_(this,e),this._initContainer(t),this._initLayout(),this._onResize=a(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),void 0!==e.zoom&&(this._zoom=this._limitZoom(e.zoom)),e.center&&void 0!==e.zoom&&this.setView(A(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this.callInitHooks(),this._zoomAnimated=yo&&Oi&&!Vi&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),st(this._proxy,wo,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,e,n){return e=void 0===e?this._zoom:this._limitZoom(e),t=this._limitCenter(A(t),e,this.options.maxBounds),n=n||{},this._stop(),this._loaded&&!n.reset&&!0!==n&&(void 0!==n.animate&&(n.zoom=s({animate:n.animate},n.zoom),n.pan=s({animate:n.animate,duration:n.duration},n.pan)),this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,n.zoom):this._tryAnimatedPan(t,n.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(t,e),this)},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(Oi?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(Oi?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,n){var i=this.getZoomScale(e),o=this.getSize().divideBy(2),r=(t instanceof x?t:this.latLngToContainerPoint(t)).subtract(o).multiplyBy(1-1/i),s=this.containerPointToLatLng(o.add(r));return this.setView(s,e,{zoom:n})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():E(t);var n=b(e.paddingTopLeft||e.padding||[0,0]),i=b(e.paddingBottomRight||e.padding||[0,0]),o=this.getBoundsZoom(t,!1,n.add(i));if((o="number"==typeof e.maxZoom?Math.min(e.maxZoom,o):o)===1/0)return{center:t.getCenter(),zoom:o};var r=i.subtract(n).divideBy(2),s=this.project(t.getSouthWest(),o),a=this.project(t.getNorthEast(),o);return{center:this.unproject(s.add(a).divideBy(2).add(r),o),zoom:o}},fitBounds:function(t,e){if(!(t=E(t)).isValid())throw new Error("Bounds are not valid.");var n=this._getBoundsCenterZoom(t,e);return this.setView(n.center,n.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(t=b(t).round(),e=e||{},!t.x&&!t.y)return this.fire("moveend");if(!0!==e.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Mo,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){Ct(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,n,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,n){function i(t){var e=(g*g-_*_+(t?-1:1)*w*w*m*m)/(2*(t?g:_)*w*m),n=Math.sqrt(e*e+1)-e;return n<1e-9?-18:Math.log(n)}function o(t){return(Math.exp(t)-Math.exp(-t))/2}function r(t){return(Math.exp(t)+Math.exp(-t))/2}function s(t){return o(t)/r(t)}function a(t){return _*(r(x)/r(x+v*t))}function h(t){return _*(r(x)*s(x+v*t)-o(x))/w}function u(t){return 1-Math.pow(1-t,1.5)}function l(){var n=(Date.now()-L)/M,i=u(n)*b;n<=1?(this._flyToFrame=y(l,this),this._move(this.unproject(c.add(d.subtract(c).multiplyBy(h(i)/m)),p),this.getScaleZoom(_/a(i),p),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}if(!1===(n=n||{}).animate||!Oi)return this.setView(t,e,n);this._stop();var c=this.project(this.getCenter()),d=this.project(t),f=this.getSize(),p=this._zoom;t=A(t),e=void 0===e?p:e;var _=Math.max(f.x,f.y),g=_*this.getZoomScale(p,e),m=d.distanceTo(c)||1,v=1.42,w=v*v,x=i(0),L=Date.now(),b=(i(1)-x)/v,M=n.duration?1e3*n.duration:1e3*b*.8;return this._moveStart(!0),l.call(this),this},flyToBounds:function(t,e){var n=this._getBoundsCenterZoom(t,e);return this.flyTo(n.center,n.zoom,e)},setMaxBounds:function(t){return(t=E(t)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(t){return this.options.minZoom=t,this._loaded&&this.getZoom()<this.options.minZoom?this.setZoom(t):this},setMaxZoom:function(t){return this.options.maxZoom=t,this._loaded&&this.getZoom()>this.options.maxZoom?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var n=this.getCenter(),i=this._limitCenter(n,this._zoom,E(t));return n.equals(i)||this.panTo(i,e),this._enforcingBounds=!1,this},invalidateSize:function(t){if(!this._loaded)return this;t=s({animate:!1,pan:!0},!0===t?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var n=this.getSize(),i=e.divideBy(2).round(),o=n.divideBy(2).round(),r=i.subtract(o);return r.x||r.y?(t.animate&&t.pan?this.panBy(r):(t.pan&&this._rawPanBy(r),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(a(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:n})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=s({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=a(this._handleGeolocationResponse,this),n=a(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,n,t):navigator.geolocation.getCurrentPosition(e,n,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,n=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+n+"."})},_handleGeolocationResponse:function(t){var e=new T(t.coords.latitude,t.coords.longitude),n=e.toBounds(t.coords.accuracy),i=this._locateOptions;if(i.setView){var o=this.getBoundsZoom(n);this.setView(e,i.maxZoom?Math.min(o,i.maxZoom):o)}var r={latlng:e,bounds:n,timestamp:t.timestamp};for(var s in t.coords)"number"==typeof t.coords[s]&&(r[s]=t.coords[s]);this.fire("locationfound",r)},addHandler:function(t,e){if(!e)return this;var n=this[t]=new e(this);return this._handlers.push(n),this.options[t]&&n.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}kt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this._loaded&&this.fire("unload");var t;for(t in this._layers)this._layers[t].remove();for(t in this._panes)kt(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var n=Pt("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),e||this._mapPane);return t&&(this._panes[t]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new k(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,n){t=E(t),n=b(n||[0,0]);var i=this.getZoom()||0,o=this.getMinZoom(),r=this.getMaxZoom(),s=t.getNorthWest(),a=t.getSouthEast(),h=this.getSize().subtract(n),u=P(this.project(a,i),this.project(s,i)).getSize(),l=Oi?this.options.zoomSnap:1,c=h.x/u.x,d=h.y/u.y,f=e?Math.max(c,d):Math.min(c,d);return i=this.getScaleZoom(f,i),l&&(i=Math.round(i/(l/100))*(l/100),i=e?Math.ceil(i/l)*l:Math.floor(i/l)*l),Math.max(o,Math.min(r,i))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new x(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var n=this._getTopLeftPoint(t,e);return new M(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var n=this.options.crs;return e=void 0===e?this._zoom:e,n.scale(t)/n.scale(e)},getScaleZoom:function(t,e){var n=this.options.crs;e=void 0===e?this._zoom:e;var i=n.zoom(t*n.scale(e));return isNaN(i)?1/0:i},project:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.latLngToPoint(A(t),e)},unproject:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.pointToLatLng(b(t),e)},layerPointToLatLng:function(t){var e=b(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(A(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(A(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(E(t))},distance:function(t,e){return this.options.crs.distance(A(t),A(e))},containerPointToLayerPoint:function(t){return b(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return b(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(b(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(A(t)))},mouseEventToContainerPoint:function(t){return _t(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=bt(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");st(e,"scroll",this._onScroll,this),this._containerId=h(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&Oi,Ct(t,"leaflet-container"+(Fi?" leaflet-touch":"")+(Hi?" leaflet-retina":"")+(Li?" leaflet-oldie":"")+(Ci?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=Mt(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Zt(this._mapPane,new x(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ct(t.markerPane,"leaflet-zoom-hide"),Ct(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e){Zt(this._mapPane,new x(0,0));var n=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var i=this._zoom!==e;this._moveStart(i)._move(t,e)._moveEnd(i),this.fire("viewreset"),n&&this.fire("load")},_moveStart:function(t){return t&&this.fire("zoomstart"),this.fire("movestart")},_move:function(t,e,n){void 0===e&&(e=this._zoom);var i=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),(i||n&&n.pinch)&&this.fire("zoom",n),this.fire("move",n)},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return w(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){Zt(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[h(this._container)]=this;var e=t?at:st;e(this._container,"click dblclick mousedown mouseup "+"mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),Oi&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){w(this._resizeRequest),this._resizeRequest=y(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var n,i=[],o="mouseout"===e||"mouseover"===e,r=t.target||t.srcElement,s=!1;r;){if((n=this._targets[h(r)])&&("click"===e||"preclick"===e)&&!t._simulated&&this._draggableMoved(n)){s=!0;break}if(n&&n.listens(e,!0)){if(o&&!yt(r,t))break;if(i.push(n),o)break}if(r===this._container)break;r=r.parentNode}return i.length||s||o||!yt(r,t)||(i=[this]),i},_handleDOMEvent:function(t){if(this._loaded&&!vt(t)){var e=t.type;"mousedown"!==e&&"keypress"!==e||Vt(t.target||t.srcElement),this._fireDOMEvent(t,e)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,e,n){if("click"===t.type){var i=s({},t);i.type="preclick",this._fireDOMEvent(i,i.type,n)}if(!t._stopped&&(n=(n||[]).concat(this._findEventTargets(t,e))).length){var o=n[0];"contextmenu"===e&&o.listens(e,!0)&&ft(t);var r={originalEvent:t};if("keypress"!==t.type){var a=o.options&&"icon"in o.options;r.containerPoint=a?this.latLngToContainerPoint(o.getLatLng()):this.mouseEventToContainerPoint(t),r.layerPoint=this.containerPointToLayerPoint(r.containerPoint),r.latlng=a?o.getLatLng():this.layerPointToLatLng(r.layerPoint)}for(var h=0;h<n.length;h++)if(n[h].fire(e,r,!0),r.originalEvent._stopped||!1===n[h].options.bubblingMouseEvents&&-1!==g(this._mouseEvents,e))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return Rt(this._mapPane)||new x(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){return(t&&void 0!==e?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var n=this.getSize()._divideBy(2);return this.project(t,e)._subtract(n)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,n){var i=this._getNewPixelOrigin(n,e);return this.project(t,e)._subtract(i)},_latLngBoundsToNewLayerBounds:function(t,e,n){var i=this._getNewPixelOrigin(n,e);return P([this.project(t.getSouthWest(),e)._subtract(i),this.project(t.getNorthWest(),e)._subtract(i),this.project(t.getSouthEast(),e)._subtract(i),this.project(t.getNorthEast(),e)._subtract(i)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,n){if(!n)return t;var i=this.project(t,e),o=this.getSize().divideBy(2),r=new M(i.subtract(o),i.add(o)),s=this._getBoundsOffset(r,n,e);return s.round().equals([0,0])?t:this.unproject(i.add(s),e)},_limitOffset:function(t,e){if(!e)return t;var n=this.getPixelBounds(),i=new M(n.min.add(t),n.max.add(t));return t.add(this._getBoundsOffset(i,e))},_getBoundsOffset:function(t,e,n){var i=P(this.project(e.getNorthEast(),n),this.project(e.getSouthWest(),n)),o=i.min.subtract(t.min),r=i.max.subtract(t.max);return new x(this._rebound(o.x,-r.x),this._rebound(o.y,-r.y))},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),n=this.getMaxZoom(),i=Oi?this.options.zoomSnap:1;return i&&(t=Math.round(t/i)*i),Math.max(e,Math.min(n,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){St(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var n=this._getCenterOffset(t)._floor();return!(!0!==(e&&e.animate)&&!this.getSize().contains(n))&&(this.panBy(n,e),!0)},_createAnimProxy:function(){var t=this._proxy=Pt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(t){var e=vo,n=this._proxy.style[e];Ot(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),n===this._proxy.style[e]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",function(){var t=this.getCenter(),e=this.getZoom();Ot(this._proxy,this.project(t,e),this.getZoomScale(e,1))},this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){kt(this._proxy),delete this._proxy},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||!1===n.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var i=this.getZoomScale(e),o=this._getCenterOffset(t)._divideBy(1-1/i);return!(!0!==n.animate&&!this.getSize().contains(o))&&(y(function(){this._moveStart(!0)._animateZoom(t,e,!0)},this),!0)},_animateZoom:function(t,e,n,i){n&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,Ct(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:i}),setTimeout(a(this._onZoomTransitionEnd,this),250)},_onZoomTransitionEnd:function(){this._animatingZoom&&(St(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),y(function(){this._moveEnd(!0)},this))}});Po.mergeOptions({boxZoom:!0});var ko=$i.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){st(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){at(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){kt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),po(),jt(),this._startPoint=this._map.mouseEventToContainerPoint(t),st(document,{contextmenu:pt,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=Pt("div","leaflet-zoom-box",this._container),Ct(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new M(this._point,this._startPoint),n=e.getSize();Zt(this._box,e.min),this._box.style.width=n.x+"px",this._box.style.height=n.y+"px"},_finish:function(){this._moved&&(kt(this._box),St(this._container,"leaflet-crosshair")),_o(),Ft(),at(document,{contextmenu:pt,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(a(this._resetState,this),0);var e=new k(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}});Po.addInitHook("addHandler","boxZoom",ko),Po.mergeOptions({doubleClickZoom:!0});var Eo=$i.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,n=e.getZoom(),i=e.options.zoomDelta,o=t.originalEvent.shiftKey?n-i:n+i;"center"===e.options.doubleClickZoom?e.setZoom(o):e.setZoomAround(t.containerPoint,o)}});Po.addInitHook("addHandler","doubleClickZoom",Eo);var To=Fi?"touchstart mousedown":"mousedown",Ao={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},Co={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},So=Yi.extend({options:{clickTolerance:3},initialize:function(t,e,n,i){_(this,i),this._element=t,this._dragStartTarget=e||t,this._preventOutline=n},enable:function(){this._enabled||(st(this._dragStartTarget,To,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(So._dragging===this&&this.finishDrag(),at(this._dragStartTarget,To,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(!t._simulated&&this._enabled&&(this._moved=!1,!At(this._element,"leaflet-zoom-anim")&&!(So._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(So._dragging=this,this._preventOutline&&Vt(this._element),jt(),po(),this._moving)))){this.fire("down");var e=t.touches?t.touches[0]:t;this._startPoint=new x(e.clientX,e.clientY),st(document,Co[t.type],this._onMove,this),st(document,Ao[t.type],this._onUp,this)}},_onMove:function(t){if(!t._simulated&&this._enabled)if(t.touches&&t.touches.length>1)this._moved=!0;else{var e=t.touches&&1===t.touches.length?t.touches[0]:t,n=new x(e.clientX,e.clientY).subtract(this._startPoint);(n.x||n.y)&&(Math.abs(n.x)+Math.abs(n.y)<this.options.clickTolerance||(ft(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=Rt(this._element).subtract(n),Ct(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ct(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,w(this._animRequest),this._lastEvent=t,this._animRequest=y(this._updatePosition,this,!0)))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),Zt(this._element,this._newPos),this.fire("drag",t)},_onUp:function(t){!t._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){St(document.body,"leaflet-dragging"),this._lastTarget&&(St(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var t in Co)at(document,Co[t],this._onMove,this),at(document,Ao[t],this._onUp,this);Ft(),_o(),this._moved&&this._moving&&(w(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,So._dragging=!1}});Po.mergeOptions({dragging:!0,inertia:!ki,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var zo=$i.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new So(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}Ct(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){St(this._map._container,"leaflet-grab"),St(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=E(this._map.options.maxBounds);this._offsetLimit=P(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,n=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(n),this._times.push(e),e-this._times[0]>50&&(this._positions.shift(),this._times.shift())}this._map.fire("move",t).fire("drag",t)},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),n=this._initialWorldOffset,i=this._draggable._newPos.x,o=(i-e+n)%t+e-n,r=(i+e+n)%t-e-n,s=Math.abs(o+n)<Math.abs(r+n)?o:r;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=s},_onDragEnd:function(t){var e=this._map,n=e.options,i=!n.inertia||this._times.length<2;if(e.fire("dragend",t),i)e.fire("moveend");else{var o=this._lastPos.subtract(this._positions[0]),r=(this._lastTime-this._times[0])/1e3,s=n.easeLinearity,a=o.multiplyBy(s/r),h=a.distanceTo([0,0]),u=Math.min(n.inertiaMaxSpeed,h),l=a.multiplyBy(u/h),c=u/(n.inertiaDeceleration*s),d=l.multiplyBy(-c/2).round();d.x||d.y?(d=e._limitOffset(d,e.options.maxBounds),y(function(){e.panBy(d,{duration:c,easeLinearity:s,noMoveStart:!0,animate:!0})})):e.fire("moveend")}}});Po.addInitHook("addHandler","dragging",zo),Po.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Do=$i.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),st(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),at(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,n=t.scrollTop||e.scrollTop,i=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(i,n)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,n,i=this._panKeys={},o=this.keyCodes;for(e=0,n=o.left.length;e<n;e++)i[o.left[e]]=[-1*t,0];for(e=0,n=o.right.length;e<n;e++)i[o.right[e]]=[t,0];for(e=0,n=o.down.length;e<n;e++)i[o.down[e]]=[0,t];for(e=0,n=o.up.length;e<n;e++)i[o.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,n,i=this._zoomKeys={},o=this.keyCodes;for(e=0,n=o.zoomIn.length;e<n;e++)i[o.zoomIn[e]]=t;for(e=0,n=o.zoomOut.length;e<n;e++)i[o.zoomOut[e]]=-t},_addHooks:function(){st(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){at(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,n=t.keyCode,i=this._map;if(n in this._panKeys){if(i._panAnim&&i._panAnim._inProgress)return;e=this._panKeys[n],t.shiftKey&&(e=b(e).multiplyBy(3)),i.panBy(e),i.options.maxBounds&&i.panInsideBounds(i.options.maxBounds)}else if(n in this._zoomKeys)i.setZoom(i.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[n]);else{if(27!==n||!i._popup)return;i.closePopup()}pt(t)}}});Po.addInitHook("addHandler","keyboard",Do),Po.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Bo=$i.extend({addHooks:function(){st(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){at(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=gt(t),n=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var i=Math.max(n-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(a(this._performZoom,this),i),pt(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),n=this._map.options.zoomSnap||0;t._stop();var i=this._delta/(4*this._map.options.wheelPxPerZoomLevel),o=4*Math.log(2/(1+Math.exp(-Math.abs(i))))/Math.LN2,r=n?Math.ceil(o/n)*n:o,s=t._limitZoom(e+(this._delta>0?r:-r))-e;this._delta=0,this._startTime=null,s&&("center"===t.options.scrollWheelZoom?t.setZoom(e+s):t.setZoomAround(this._lastMousePos,e+s))}});Po.addInitHook("addHandler","scrollWheelZoom",Bo),Po.mergeOptions({tap:!0,tapTolerance:15});var Io=$i.extend({addHooks:function(){st(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){at(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(ft(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var e=t.touches[0],n=e.target;this._startPos=this._newPos=new x(e.clientX,e.clientY),n.tagName&&"a"===n.tagName.toLowerCase()&&Ct(n,"leaflet-active"),this._holdTimeout=setTimeout(a(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))},this),1e3),this._simulateEvent("mousedown",e),st(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),at(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],n=e.target;n&&n.tagName&&"a"===n.tagName.toLowerCase()&&St(n,"leaflet-active"),this._simulateEvent("mouseup",e),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new x(e.clientX,e.clientY),this._simulateEvent("mousemove",e)},_simulateEvent:function(t,e){var n=document.createEvent("MouseEvents");n._simulated=!0,e.target._simulatedClick=!0,n.initMouseEvent(t,!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(n)}});Fi&&!ji&&Po.addInitHook("addHandler","tap",Io),Po.mergeOptions({touchZoom:Fi&&!ki,bounceAtZoomLimits:!0});var No=$i.extend({addHooks:function(){Ct(this._map._container,"leaflet-touch-zoom"),st(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){St(this._map._container,"leaflet-touch-zoom"),at(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var n=e.mouseEventToContainerPoint(t.touches[0]),i=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),"center"!==e.options.touchZoom&&(this._pinchStartLatLng=e.containerPointToLatLng(n.add(i)._divideBy(2))),this._startDist=n.distanceTo(i),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),st(document,"touchmove",this._onTouchMove,this),st(document,"touchend",this._onTouchEnd,this),ft(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,n=e.mouseEventToContainerPoint(t.touches[0]),i=e.mouseEventToContainerPoint(t.touches[1]),o=n.distanceTo(i)/this._startDist;if(this._zoom=e.getScaleZoom(o,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&o<1||this._zoom>e.getMaxZoom()&&o>1)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===o)return}else{var r=n._add(i)._divideBy(2)._subtract(this._centerPoint);if(1===o&&0===r.x&&0===r.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(r),this._zoom)}this._moved||(e._moveStart(!0),this._moved=!0),w(this._animRequest);var s=a(e._move,e,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=y(s,this,!0),ft(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,w(this._animRequest),at(document,"touchmove",this._onTouchMove),at(document,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});Po.addInitHook("addHandler","touchZoom",No),Po.BoxZoom=ko,Po.DoubleClickZoom=Eo,Po.Drag=zo,Po.Keyboard=Do,Po.ScrollWheelZoom=Bo,Po.Tap=Io,Po.TouchZoom=No;var Oo=I.extend({initialize:function(t){_(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var n=this._getIconUrl(t);if(!n){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var i=this._createImg(n,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(i,t),i},_setIconStyles:function(t,e){var n=this.options,i=n[e+"Size"];"number"==typeof i&&(i=[i,i]);var o=b(i),r=b("shadow"===e&&n.shadowAnchor||n.iconAnchor||o&&o.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(n.className||""),r&&(t.style.marginLeft=-r.x+"px",t.style.marginTop=-r.y+"px"),o&&(t.style.width=o.x+"px",t.style.height=o.y+"px")},_createImg:function(t,e){return e=e||document.createElement("img"),e.src=t,e},_getIconUrl:function(t){return Hi&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}}),Zo=Oo.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return Zo.imagePath||(Zo.imagePath=this._detectIconPath()),(this.options.imagePath||Zo.imagePath)+Oo.prototype._getIconUrl.call(this,t)},_detectIconPath:function(){var t=Pt("div","leaflet-default-icon-path",document.body),e=Mt(t,"background-image")||Mt(t,"backgroundImage");return document.body.removeChild(t),e=null===e||0!==e.indexOf("url")?"":e.replace(/^url\([\"\']?/,"").replace(/marker-icon\.png[\"\']?\)$/,"")}}),Ro=Oo.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:document.createElement("div"),n=this.options;if(e.innerHTML=!1!==n.html?n.html:"",n.bgPos){var i=b(n.bgPos);e.style.backgroundPosition=-i.x+"px "+-i.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}}),jo=Yi.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[h(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[h(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var n=this.getEvents();e.on(n,this),this.once("remove",function(){e.off(n,this)},this)}this.onAdd(e),this.getAttribution&&e.attributionControl&&e.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),e.fire("layeradd",{layer:this})}}});Po.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=h(t);return this._layers[e]?this:(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var e=h(t);return this._layers[e]?(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return!!t&&h(t)in this._layers},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},_addLayers:function(t){for(var e=0,n=(t=t?ri(t)?t:[t]:[]).length;e<n;e++)this.addLayer(t[e])},_addZoomLimit:function(t){!isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[h(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=h(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,n=this._getZoomSpan();for(var i in this._zoomBoundLayers){var o=this._zoomBoundLayers[i].options;t=void 0===o.minZoom?t:Math.min(t,o.minZoom),e=void 0===o.maxZoom?e:Math.max(e,o.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,n!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Fo=$i.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new So(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ct(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&St(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(t){var e=this._marker,n=e._shadow,i=Rt(e._icon),o=e._map.layerPointToLatLng(i);n&&Zt(n,i),e._latlng=o,t.latlng=o,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Vo=jo.extend({options:{icon:new Zo,interactive:!0,draggable:!1,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",bubblingMouseEvents:!1},initialize:function(t,e){_(this,e),this._latlng=A(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=A(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),n=t.icon.createIcon(this._icon),i=!1;n!==this._icon&&(this._icon&&this._removeIcon(),i=!0,t.title&&(n.title=t.title),t.alt&&(n.alt=t.alt)),Ct(n,e),t.keyboard&&(n.tabIndex="0"),this._icon=n,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var o=t.icon.createShadow(this._shadow),r=!1;o!==this._shadow&&(this._removeShadow(),r=!0),o&&(Ct(o,e),o.alt=""),this._shadow=o,t.opacity<1&&this._updateOpacity(),i&&this.getPane().appendChild(this._icon),this._initInteraction(),o&&r&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),kt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&kt(this._shadow),this._shadow=null},_setPos:function(t){Zt(this._icon,t),this._shadow&&Zt(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(Ct(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Fo)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Fo(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;Bt(this._icon,t),this._shadow&&Bt(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor||[0,0]},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor||[0,0]}});Oo.Default=Zo;var Ho=jo.extend({initialize:function(t){this._layers={};var e,n;if(t)for(e=0,n=t.length;e<n;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){for(var t in this._layers)this.removeLayer(this._layers[t]);return this},invoke:function(t){var e,n,i=Array.prototype.slice.call(arguments,1);for(e in this._layers)(n=this._layers[e])[t]&&n[t].apply(n,i);return this},onAdd:function(t){for(var e in this._layers)t.addLayer(this._layers[e])},onRemove:function(t){for(var e in this._layers)t.removeLayer(this._layers[e])},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return h(t)}}),Wo=jo.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return _(this,t),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(Fi?10:0)}}),Go=Wo.extend({options:{fill:!0,radius:10},initialize:function(t,e){_(this,e),this._latlng=A(t),this._radius=this.options.radius},setLatLng:function(t){return this._latlng=A(t),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return Wo.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,n=this._clickTolerance(),i=[t+n,e+n];this._pxBounds=new M(this._point.subtract(i),this._point.add(i))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}}).extend({initialize:function(t,e,n){if("number"==typeof e&&(e=s({},n,{radius:e})),_(this,e),this._latlng=A(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new k(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:Wo.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,n=this._map,i=n.options.crs;if(i.distance===li.distance){var o=Math.PI/180,r=this._mRadius/li.R/o,s=n.project([e+r,t]),a=n.project([e-r,t]),h=s.add(a).divideBy(2),u=n.unproject(h).lat,l=Math.acos((Math.cos(r*o)-Math.sin(e*o)*Math.sin(u*o))/(Math.cos(e*o)*Math.cos(u*o)))/o;(isNaN(l)||0===l)&&(l=r/Math.cos(Math.PI/180*e)),this._point=h.subtract(n.getPixelOrigin()),this._radius=isNaN(l)?0:Math.max(Math.round(h.x-n.project([u,t-l]).x),1),this._radiusY=Math.max(Math.round(h.y-s.y),1)}else{var c=i.unproject(i.project(this._latlng).subtract([this._mRadius,0]));this._point=n.latLngToLayerPoint(this._latlng),this._radius=this._point.x-n.latLngToLayerPoint(c).x}this._updateBounds()}}),qo=Wo.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){_(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,n,i=1/0,o=null,r=q,s=0,a=this._parts.length;s<a;s++)for(var h=this._parts[s],u=1,l=h.length;u<l;u++){var c=r(t,e=h[u-1],n=h[u],!0);c<i&&(i=c,o=r(t,e,n))}return o&&(o.distance=Math.sqrt(i)),o},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,n,i,o,r,s,a=this._rings[0],h=a.length;if(!h)return null;for(t=0,e=0;t<h-1;t++)e+=a[t].distanceTo(a[t+1])/2;if(0===e)return this._map.layerPointToLatLng(a[0]);for(t=0,i=0;t<h-1;t++)if(o=a[t],r=a[t+1],n=o.distanceTo(r),(i+=n)>e)return s=(i-e)/n,this._map.layerPointToLatLng([r.x-s*(r.x-o.x),r.y-s*(r.y-o.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=A(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new k,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return U(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],n=U(t),i=0,o=t.length;i<o;i++)n?(e[i]=A(t[i]),this._bounds.extend(e[i])):e[i]=this._convertLatLngs(t[i]);return e},_project:function(){var t=new M;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t);var e=this._clickTolerance(),n=new x(e,e);this._bounds.isValid()&&t.isValid()&&(t.min._subtract(n),t.max._add(n),this._pxBounds=t)},_projectLatlngs:function(t,e,n){var i,o,r=t[0]instanceof T,s=t.length;if(r){for(o=[],i=0;i<s;i++)o[i]=this._map.latLngToLayerPoint(t[i]),n.extend(o[i]);e.push(o)}else for(i=0;i<s;i++)this._projectLatlngs(t[i],e,n)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else{var e,n,i,o,r,s,a,h=this._parts;for(e=0,i=0,o=this._rings.length;e<o;e++)for(n=0,r=(a=this._rings[e]).length;n<r-1;n++)(s=V(a[n],a[n+1],t,n,!0))&&(h[i]=h[i]||[],h[i].push(s[0]),s[1]===a[n+1]&&n!==r-2||(h[i].push(s[1]),i++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,n=0,i=t.length;n<i;n++)t[n]=O(t[n],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var n,i,o,r,s,a,h=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(n=0,r=this._parts.length;n<r;n++)for(i=0,o=(s=(a=this._parts[n]).length)-1;i<s;o=i++)if((e||0!==i)&&Z(t,a[o],a[i])<=h)return!0;return!1}});qo._flat=K;var Uo=qo.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,n,i,o,r,s,a,h,u=this._rings[0],l=u.length;if(!l)return null;for(r=s=a=0,t=0,e=l-1;t<l;e=t++)n=u[t],i=u[e],o=n.y*i.x-i.y*n.x,s+=(n.x+i.x)*o,a+=(n.y+i.y)*o,r+=3*o;return h=0===r?u[0]:[s/r,a/r],this._map.layerPointToLatLng(h)},_convertLatLngs:function(t){var e=qo.prototype._convertLatLngs.call(this,t),n=e.length;return n>=2&&e[0]instanceof T&&e[0].equals(e[n-1])&&e.pop(),e},_setLatLngs:function(t){qo.prototype._setLatLngs.call(this,t),U(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return U(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,n=new x(e,e);if(t=new M(t.min.subtract(n),t.max.add(n)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var i,o=0,r=this._rings.length;o<r;o++)(i=Gt(this._rings[o],t,!0)).length&&this._parts.push(i)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e,n,i,o,r,s,a,h,u=!1;if(!this._pxBounds.contains(t))return!1;for(o=0,a=this._parts.length;o<a;o++)for(r=0,s=(h=(e=this._parts[o]).length)-1;r<h;s=r++)n=e[r],i=e[s],n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(u=!u);return u||qo.prototype._containsPoint.call(this,t,!0)}}),Ko=Uo.extend({initialize:function(t,e){Uo.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=E(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),Xo=Yi.extend({statics:{FORWARD:1,BACKWARD:-1},options:{zIndex:1e3,polygonClass:Uo,polylineClass:qo,markerClass:Vo,rectangleClass:Ko,circleClass:Go,drawingCSSClass:"leaflet-editable-drawing",drawingCursor:"crosshair",editLayer:void 0,featuresLayer:void 0,polylineEditorClass:void 0,polygonEditorClass:void 0,markerEditorClass:void 0,rectangleEditorClass:void 0,circleEditorClass:void 0,lineGuideOptions:{},skipMiddleMarkers:!1},initialize:function(t,e){_(this,e),this._lastZIndex=this.options.zIndex,this.map=t,this.editLayer=this.createEditLayer(),this.featuresLayer=this.createFeaturesLayer(),this.forwardLineGuide=this.createLineGuide(),this.backwardLineGuide=this.createLineGuide()},fireAndForward:function(t,e){(e=e||{}).editTools=this,this.fire(t,e),this.map.fire(t,e)},createLineGuide:function(){return Wt([],s({dashArray:"5,10",weight:1,interactive:!1},this.options.lineGuideOptions))},createVertexIcon:function(t){return Fi?new Xo.TouchVertexIcon(t):new Xo.VertexIcon(t)},createEditLayer:function(){return this.options.editLayer||(new Ho).addTo(this.map)},createFeaturesLayer:function(){return this.options.featuresLayer||(new Ho).addTo(this.map)},moveForwardLineGuide:function(t){this.forwardLineGuide._latlngs.length&&(this.forwardLineGuide._latlngs[1]=t,this.forwardLineGuide._bounds.extend(t),this.forwardLineGuide.redraw())},moveBackwardLineGuide:function(t){this.backwardLineGuide._latlngs.length&&(this.backwardLineGuide._latlngs[1]=t,this.backwardLineGuide._bounds.extend(t),this.backwardLineGuide.redraw())},anchorForwardLineGuide:function(t){this.forwardLineGuide._latlngs[0]=t,this.forwardLineGuide._bounds.extend(t),this.forwardLineGuide.redraw()},anchorBackwardLineGuide:function(t){this.backwardLineGuide._latlngs[0]=t,this.backwardLineGuide._bounds.extend(t),this.backwardLineGuide.redraw()},attachForwardLineGuide:function(){this.editLayer.addLayer(this.forwardLineGuide)},attachBackwardLineGuide:function(){this.editLayer.addLayer(this.backwardLineGuide)},detachForwardLineGuide:function(){this.forwardLineGuide.setLatLngs([]),this.editLayer.removeLayer(this.forwardLineGuide)},detachBackwardLineGuide:function(){this.backwardLineGuide.setLatLngs([]),this.editLayer.removeLayer(this.backwardLineGuide)},blockEvents:function(){this._oldTargets||(this._oldTargets=this.map._targets,this.map._targets={})},unblockEvents:function(){this._oldTargets&&(this.map._targets=s(this.map._targets,this._oldTargets),delete this._oldTargets)},registerForDrawing:function(t){this._drawingEditor&&this.unregisterForDrawing(this._drawingEditor),this.blockEvents(),t.reset(),this._drawingEditor=t,this.map.on("mousemove touchmove",t.onDrawingMouseMove,t),this.map.on("mousedown",this.onMousedown,this),this.map.on("mouseup",this.onMouseup,this),Ct(this.map._container,this.options.drawingCSSClass),this.defaultMapCursor=this.map._container.style.cursor,this.map._container.style.cursor=this.options.drawingCursor},unregisterForDrawing:function(t){this.unblockEvents(),St(this.map._container,this.options.drawingCSSClass),this.map._container.style.cursor=this.defaultMapCursor,(t=t||this._drawingEditor)&&(this.map.off("mousemove touchmove",t.onDrawingMouseMove,t),this.map.off("mousedown",this.onMousedown,this),this.map.off("mouseup",this.onMouseup,this),t===this._drawingEditor&&(delete this._drawingEditor,t._drawing&&t.cancelDrawing()))},onMousedown:function(t){this._mouseDown=t,this._drawingEditor.onDrawingMouseDown(t)},onMouseup:function(t){if(this._mouseDown){var e=this._drawingEditor,n=this._mouseDown;if(this._mouseDown=null,e.onDrawingMouseUp(t),this._drawingEditor!==e)return;var i=b(n.originalEvent.clientX,n.originalEvent.clientY),o=b(t.originalEvent.clientX,t.originalEvent.clientY).distanceTo(i);Math.abs(o)<9*(window.devicePixelRatio||1)&&this._drawingEditor.onDrawingClick(t)}},drawing:function(){return this._drawingEditor&&this._drawingEditor.drawing()},stopDrawing:function(){this.unregisterForDrawing()},commitDrawing:function(t){this._drawingEditor&&this._drawingEditor.commitDrawing(t)},connectCreatedToMap:function(t){return this.featuresLayer.addLayer(t)},startPolyline:function(t,e){var n=this.createPolyline([],e);return n.enableEdit(this.map).newShape(t),n},startPolygon:function(t,e){var n=this.createPolygon([],e);return n.enableEdit(this.map).newShape(t),n},startMarker:function(t,e){t=t||this.map.getCenter().clone();var n=this.createMarker(t,e);return n.enableEdit(this.map).startDrawing(),n},startRectangle:function(t,e){var n=t||A([0,0]),i=E(n,n),o=this.createRectangle(i,e);return o.enableEdit(this.map).startDrawing(),o},startCircle:function(t,e){t=t||this.map.getCenter().clone();var n=this.createCircle(t,e);return n.enableEdit(this.map).startDrawing(),n},startHole:function(t,e){t.newHole(e)},createLayer:function(t,e,n){var i=new t(e,n=s({editOptions:{editTools:this}},n));return this.fireAndForward("editable:created",{layer:i}),i},createPolyline:function(t,e){return this.createLayer(e&&e.polylineClass||this.options.polylineClass,t,e)},createPolygon:function(t,e){return this.createLayer(e&&e.polygonClass||this.options.polygonClass,t,e)},createMarker:function(t,e){return this.createLayer(e&&e.markerClass||this.options.markerClass,t,e)},createRectangle:function(t,e){return this.createLayer(e&&e.rectangleClass||this.options.rectangleClass,t,e)},createCircle:function(t,e){return this.createLayer(e&&e.circleClass||this.options.circleClass,t,e)}});s(Xo,{makeCancellable:function(t){t.cancel=function(){t._cancelled=!0}}}),Po.mergeOptions({editToolsClass:Xo,editable:!1,editOptions:{}}),Po.addInitHook(function(){this.whenReady(function(){this.options.editable&&(this.editTools=new this.options.editToolsClass(this,this.options.editOptions))})}),Xo.VertexIcon=Ro.extend({options:{iconSize:b(8,8)}}),Xo.TouchVertexIcon=Xo.VertexIcon.extend({options:{iconSize:b(20,20)}}),Xo.VertexMarker=Vo.extend({options:{draggable:!0,className:"leaflet-div-icon leaflet-vertex-icon"},initialize:function(t,e,n,i){this.latlng=t,this.latlngs=e,this.editor=n,Vo.prototype.initialize.call(this,t,i),this.options.icon=this.editor.tools.createVertexIcon({className:this.options.className}),this.latlng.__vertex=this,this.editor.editLayer.addLayer(this),this.setZIndexOffset(n.tools._lastZIndex+1)},onAdd:function(t){Vo.prototype.onAdd.call(this,t),this.on("drag",this.onDrag),this.on("dragstart",this.onDragStart),this.on("dragend",this.onDragEnd),this.on("mouseup",this.onMouseup),this.on("click",this.onClick),this.on("contextmenu",this.onContextMenu),this.on("mousedown touchstart",this.onMouseDown),this.addMiddleMarkers()},onRemove:function(t){this.middleMarker&&this.middleMarker.delete(),delete this.latlng.__vertex,this.off("drag",this.onDrag),this.off("dragstart",this.onDragStart),this.off("dragend",this.onDragEnd),this.off("mouseup",this.onMouseup),this.off("click",this.onClick),this.off("contextmenu",this.onContextMenu),this.off("mousedown touchstart",this.onMouseDown),Vo.prototype.onRemove.call(this,t)},onDrag:function(t){t.vertex=this,this.editor.onVertexMarkerDrag(t);var e=Rt(this._icon),n=this._map.layerPointToLatLng(e);this.latlng.update(n),this._latlng=this.latlng,this.editor.refresh(),this.middleMarker&&this.middleMarker.updateLatLng();var i=this.getNext();i&&i.middleMarker&&i.middleMarker.updateLatLng()},onDragStart:function(t){t.vertex=this,this.editor.onVertexMarkerDragStart(t)},onDragEnd:function(t){t.vertex=this,this.editor.onVertexMarkerDragEnd(t)},onClick:function(t){t.vertex=this,this.editor.onVertexMarkerClick(t)},onMouseup:function(t){pt(t),t.vertex=this,this.editor.map.fire("mouseup",t)},onContextMenu:function(t){t.vertex=this,this.editor.onVertexMarkerContextMenu(t)},onMouseDown:function(t){t.vertex=this,this.editor.onVertexMarkerMouseDown(t)},delete:function(){var t=this.getNext();this.latlngs.splice(this.getIndex(),1),this.editor.editLayer.removeLayer(this),this.editor.onVertexDeleted({latlng:this.latlng,vertex:this}),this.latlngs.length||this.editor.deleteShape(this.latlngs),t&&t.resetMiddleMarker(),this.editor.refresh()},getIndex:function(){return this.latlngs.indexOf(this.latlng)},getLastIndex:function(){return this.latlngs.length-1},getPrevious:function(){if(!(this.latlngs.length<2)){var t=this.getIndex(),e=t-1;0===t&&this.editor.CLOSED&&(e=this.getLastIndex());var n=this.latlngs[e];return n?n.__vertex:void 0}},getNext:function(){if(!(this.latlngs.length<2)){var t=this.getIndex(),e=t+1;t===this.getLastIndex()&&this.editor.CLOSED&&(e=0);var n=this.latlngs[e];return n?n.__vertex:void 0}},addMiddleMarker:function(t){this.editor.hasMiddleMarkers()&&(t=t||this.getPrevious())&&!this.middleMarker&&(this.middleMarker=this.editor.addMiddleMarker(t,this,this.latlngs,this.editor))},addMiddleMarkers:function(){if(this.editor.hasMiddleMarkers()){var t=this.getPrevious();t&&this.addMiddleMarker(t);var e=this.getNext();e&&e.resetMiddleMarker()}},resetMiddleMarker:function(){this.middleMarker&&this.middleMarker.delete(),this.addMiddleMarker()},split:function(){this.editor.splitShape&&this.editor.splitShape(this.latlngs,this.getIndex())},continue:function(){if(this.editor.continueBackward){var t=this.getIndex();0===t?this.editor.continueBackward(this.latlngs):t===this.getLastIndex()&&this.editor.continueForward(this.latlngs)}}}),Xo.mergeOptions({vertexMarkerClass:Xo.VertexMarker}),Xo.MiddleMarker=Vo.extend({options:{opacity:.5,className:"leaflet-div-icon leaflet-middle-icon",draggable:!0},initialize:function(t,e,n,i,o){this.left=t,this.right=e,this.editor=i,this.latlngs=n,Vo.prototype.initialize.call(this,this.computeLatLng(),o),this._opacity=this.options.opacity,this.options.icon=this.editor.tools.createVertexIcon({className:this.options.className}),this.editor.editLayer.addLayer(this),this.setVisibility()},setVisibility:function(){var t=this._map.latLngToContainerPoint(this.left.latlng),e=this._map.latLngToContainerPoint(this.right.latlng),n=b(this.options.icon.options.iconSize);t.distanceTo(e)<3*n.x?this.hide():this.show()},show:function(){this.setOpacity(this._opacity)},hide:function(){this.setOpacity(0)},updateLatLng:function(){this.setLatLng(this.computeLatLng()),this.setVisibility()},computeLatLng:function(){var t=this.editor.map.latLngToContainerPoint(this.left.latlng),e=this.editor.map.latLngToContainerPoint(this.right.latlng),n=(t.y+e.y)/2,i=(t.x+e.x)/2;return this.editor.map.containerPointToLatLng([i,n])},onAdd:function(t){Vo.prototype.onAdd.call(this,t),st(this._icon,"mousedown touchstart",this.onMouseDown,this),t.on("zoomend",this.setVisibility,this)},onRemove:function(t){delete this.right.middleMarker,at(this._icon,"mousedown touchstart",this.onMouseDown,this),t.off("zoomend",this.setVisibility,this),Vo.prototype.onRemove.call(this,t)},onMouseDown:function(t){var e=Rt(this._icon);if(t={originalEvent:t,latlng:this.editor.map.layerPointToLatLng(e)},0!==this.options.opacity&&(Xo.makeCancellable(t),this.editor.onMiddleMarkerMouseDown(t),!t._cancelled)){this.latlngs.splice(this.index(),0,t.latlng),this.editor.refresh();var n=this._icon,i=this.editor.addVertexMarker(t.latlng,this.latlngs);this.editor.onNewVertex(i);var o=i._icon.parentNode;o.removeChild(i._icon),i._icon=n,o.appendChild(i._icon),i._initIcon(),i._initInteraction(),i.setOpacity(1),So._dragging=!1,i.dragging._draggable._onDown(t.originalEvent),this.delete()}},delete:function(){this.editor.editLayer.removeLayer(this)},index:function(){return this.latlngs.indexOf(this.right.latlng)}}),Xo.mergeOptions({middleMarkerClass:Xo.MiddleMarker}),Xo.BaseEditor=$i.extend({initialize:function(t,e,n){_(this,n),this.map=t,this.feature=e,this.feature.editor=this,this.editLayer=new Ho,this.tools=this.options.editTools||t.editTools},addHooks:function(){this.isConnected()?this.onFeatureAdd():this.feature.once("add",this.onFeatureAdd,this),this.onEnable(),this.feature.on(this._getEvents(),this)},removeHooks:function(){this.feature.off(this._getEvents(),this),this.feature.dragging&&this.feature.dragging.disable(),this.editLayer.clearLayers(),this.tools.editLayer.removeLayer(this.editLayer),this.onDisable(),this._drawing&&this.cancelDrawing()},drawing:function(){return!!this._drawing},reset:function(){},onFeatureAdd:function(){this.tools.editLayer.addLayer(this.editLayer),this.feature.dragging&&this.feature.dragging.enable()},hasMiddleMarkers:function(){return!this.options.skipMiddleMarkers&&!this.tools.options.skipMiddleMarkers},fireAndForward:function(t,e){(e=e||{}).layer=this.feature,this.feature.fire(t,e),this.tools.fireAndForward(t,e)},onEnable:function(){this.fireAndForward("editable:enable")},onDisable:function(){this.fireAndForward("editable:disable")},onEditing:function(){this.fireAndForward("editable:editing")},onStartDrawing:function(){this.fireAndForward("editable:drawing:start")},onEndDrawing:function(){this.fireAndForward("editable:drawing:end")},onCancelDrawing:function(){this.fireAndForward("editable:drawing:cancel")},onCommitDrawing:function(t){this.fireAndForward("editable:drawing:commit",t)},onDrawingMouseDown:function(t){this.fireAndForward("editable:drawing:mousedown",t)},onDrawingMouseUp:function(t){this.fireAndForward("editable:drawing:mouseup",t)},startDrawing:function(){this._drawing||(this._drawing=Xo.FORWARD),this.tools.registerForDrawing(this),this.onStartDrawing()},commitDrawing:function(t){this.onCommitDrawing(t),this.endDrawing()},cancelDrawing:function(){So._dragging=!1,this.onCancelDrawing(),this.endDrawing()},endDrawing:function(){this._drawing=!1,this.tools.unregisterForDrawing(this),this.onEndDrawing()},onDrawingClick:function(t){this.drawing()&&(Xo.makeCancellable(t),this.fireAndForward("editable:drawing:click",t),t._cancelled||(this.isConnected()||this.connect(t),this.processDrawingClick(t)))},isConnected:function(){return this.map.hasLayer(this.feature)},connect:function(t){this.tools.connectCreatedToMap(this.feature),this.tools.editLayer.addLayer(this.editLayer)},onMove:function(t){this.fireAndForward("editable:drawing:move",t)},onDrawingMouseMove:function(t){this.onMove(t)},_getEvents:function(){return{dragstart:this.onDragStart,drag:this.onDrag,dragend:this.onDragEnd,remove:this.disable}},onDragStart:function(t){this.onEditing(),this.fireAndForward("editable:dragstart",t)},onDrag:function(t){this.onMove(t),this.fireAndForward("editable:drag",t)},onDragEnd:function(t){this.fireAndForward("editable:dragend",t)}}),Xo.MarkerEditor=Xo.BaseEditor.extend({onDrawingMouseMove:function(t){Xo.BaseEditor.prototype.onDrawingMouseMove.call(this,t),this._drawing&&this.feature.setLatLng(t.latlng)},processDrawingClick:function(t){this.fireAndForward("editable:drawing:clicked",t),this.commitDrawing(t)},connect:function(t){t&&(this.feature._latlng=t.latlng),Xo.BaseEditor.prototype.connect.call(this,t)}}),Xo.PathEditor=Xo.BaseEditor.extend({CLOSED:!1,MIN_VERTEX:2,addHooks:function(){return Xo.BaseEditor.prototype.addHooks.call(this),this.feature&&this.initVertexMarkers(),this},initVertexMarkers:function(t){if(this.enabled())if(t=t||this.getLatLngs(),ir(t))this.addVertexMarkers(t);else for(var e=0;e<t.length;e++)this.initVertexMarkers(t[e])},getLatLngs:function(){return this.feature.getLatLngs()},reset:function(){this.editLayer.clearLayers(),this.initVertexMarkers()},addVertexMarker:function(t,e){return new this.tools.options.vertexMarkerClass(t,e,this)},onNewVertex:function(t){this.fireAndForward("editable:vertex:new",{latlng:t.latlng,vertex:t})},addVertexMarkers:function(t){for(var e=0;e<t.length;e++)this.addVertexMarker(t[e],t)},refreshVertexMarkers:function(t){t=t||this.getDefaultLatLngs();for(var e=0;e<t.length;e++)t[e].__vertex.update()},addMiddleMarker:function(t,e,n){return new this.tools.options.middleMarkerClass(t,e,n,this)},onVertexMarkerClick:function(t){if(Xo.makeCancellable(t),this.fireAndForward("editable:vertex:click",t),!(t._cancelled||this.tools.drawing()&&this.tools._drawingEditor!==this)){var e,n=t.vertex.getIndex();t.originalEvent.ctrlKey?this.onVertexMarkerCtrlClick(t):t.originalEvent.altKey?this.onVertexMarkerAltClick(t):t.originalEvent.shiftKey?this.onVertexMarkerShiftClick(t):t.originalEvent.metaKey?this.onVertexMarkerMetaKeyClick(t):n===t.vertex.getLastIndex()&&this._drawing===Xo.FORWARD?n>=this.MIN_VERTEX-1&&(e=!0):0===n&&this._drawing===Xo.BACKWARD&&this._drawnLatLngs.length>=this.MIN_VERTEX?e=!0:0===n&&this._drawing===Xo.FORWARD&&this._drawnLatLngs.length>=this.MIN_VERTEX&&this.CLOSED?e=!0:this.onVertexRawMarkerClick(t),this.fireAndForward("editable:vertex:clicked",t),e&&this.commitDrawing(t)}},onVertexRawMarkerClick:function(t){this.fireAndForward("editable:vertex:rawclick",t),t._cancelled||this.vertexCanBeDeleted(t.vertex)&&t.vertex.delete()},vertexCanBeDeleted:function(t){return t.latlngs.length>this.MIN_VERTEX},onVertexDeleted:function(t){this.fireAndForward("editable:vertex:deleted",t)},onVertexMarkerCtrlClick:function(t){this.fireAndForward("editable:vertex:ctrlclick",t)},onVertexMarkerShiftClick:function(t){this.fireAndForward("editable:vertex:shiftclick",t)},onVertexMarkerMetaKeyClick:function(t){this.fireAndForward("editable:vertex:metakeyclick",t)},onVertexMarkerAltClick:function(t){this.fireAndForward("editable:vertex:altclick",t)},onVertexMarkerContextMenu:function(t){this.fireAndForward("editable:vertex:contextmenu",t)},onVertexMarkerMouseDown:function(t){this.fireAndForward("editable:vertex:mousedown",t)},onMiddleMarkerMouseDown:function(t){this.fireAndForward("editable:middlemarker:mousedown",t)},onVertexMarkerDrag:function(t){this.onMove(t),this.feature._bounds&&this.extendBounds(t),this.fireAndForward("editable:vertex:drag",t)},onVertexMarkerDragStart:function(t){this.fireAndForward("editable:vertex:dragstart",t)},onVertexMarkerDragEnd:function(t){this.fireAndForward("editable:vertex:dragend",t)},setDrawnLatLngs:function(t){this._drawnLatLngs=t||this.getDefaultLatLngs()},startDrawing:function(){this._drawnLatLngs||this.setDrawnLatLngs(),Xo.BaseEditor.prototype.startDrawing.call(this)},startDrawingForward:function(){this.startDrawing()},endDrawing:function(){this.tools.detachForwardLineGuide(),this.tools.detachBackwardLineGuide(),this._drawnLatLngs&&this._drawnLatLngs.length<this.MIN_VERTEX&&this.deleteShape(this._drawnLatLngs),Xo.BaseEditor.prototype.endDrawing.call(this),delete this._drawnLatLngs},addLatLng:function(t){this._drawing===Xo.FORWARD?this._drawnLatLngs.push(t):this._drawnLatLngs.unshift(t),this.feature._bounds.extend(t);var e=this.addVertexMarker(t,this._drawnLatLngs);this.onNewVertex(e),this.refresh()},newPointForward:function(t){this.addLatLng(t),this.tools.attachForwardLineGuide(),this.tools.anchorForwardLineGuide(t)},newPointBackward:function(t){this.addLatLng(t),this.tools.anchorBackwardLineGuide(t)},push:function(t){if(!t)return console.error("Editable.PathEditor.push expect a vaild latlng as parameter");this._drawing===Xo.FORWARD?this.newPointForward(t):this.newPointBackward(t)},removeLatLng:function(t){t.__vertex.delete(),this.refresh()},pop:function(){if(!(this._drawnLatLngs.length<=1)){var t;return t=this._drawing===Xo.FORWARD?this._drawnLatLngs[this._drawnLatLngs.length-1]:this._drawnLatLngs[0],this.removeLatLng(t),this._drawing===Xo.FORWARD?this.tools.anchorForwardLineGuide(this._drawnLatLngs[this._drawnLatLngs.length-1]):this.tools.anchorForwardLineGuide(this._drawnLatLngs[0]),t}},processDrawingClick:function(t){t.vertex&&t.vertex.editor===this||(this._drawing===Xo.FORWARD?this.newPointForward(t.latlng):this.newPointBackward(t.latlng),this.fireAndForward("editable:drawing:clicked",t))},onDrawingMouseMove:function(t){Xo.BaseEditor.prototype.onDrawingMouseMove.call(this,t),this._drawing&&(this.tools.moveForwardLineGuide(t.latlng),this.tools.moveBackwardLineGuide(t.latlng))},refresh:function(){this.feature.redraw(),this.onEditing()},newShape:function(t){var e=this.addNewEmptyShape();e&&(this.setDrawnLatLngs(e[0]||e),this.startDrawingForward(),this.fireAndForward("editable:shape:new",{shape:e}),t&&this.newPointForward(t))},deleteShape:function(t,e){var n={shape:t};if(Xo.makeCancellable(n),this.fireAndForward("editable:shape:delete",n),!n._cancelled)return t=this._deleteShape(t,e),this.ensureNotFlat&&this.ensureNotFlat(),this.feature.setLatLngs(this.getLatLngs()),this.refresh(),this.reset(),this.fireAndForward("editable:shape:deleted",{shape:t}),t},_deleteShape:function(t,e){if((e=e||this.getLatLngs()).length){var n=this,i=function(t,e){return t.splice(t.indexOf(e),1),t.length||n._deleteShape(t),e};if(e===t)return function(t,e){return t.splice(0,Number.MAX_VALUE)}(e);for(var o=0;o<e.length;o++){if(e[o]===t)return i(e,t);if(-1!==e[o].indexOf(t))return i(e[o],t)}}},deleteShapeAt:function(t){var e=this.feature.shapeAt(t);if(e)return this.deleteShape(e)},appendShape:function(t){this.insertShape(t)},prependShape:function(t){this.insertShape(t,0)},insertShape:function(t,e){this.ensureMulti(),t=this.formatShape(t),void 0===e&&(e=this.feature._latlngs.length),this.feature._latlngs.splice(e,0,t),this.feature.redraw(),this._enabled&&this.reset()},extendBounds:function(t){this.feature._bounds.extend(t.vertex.latlng)},onDragStart:function(t){this.editLayer.clearLayers(),Xo.BaseEditor.prototype.onDragStart.call(this,t)},onDragEnd:function(t){this.initVertexMarkers(),Xo.BaseEditor.prototype.onDragEnd.call(this,t)}}),Xo.PolylineEditor=Xo.PathEditor.extend({startDrawingBackward:function(){this._drawing=Xo.BACKWARD,this.startDrawing()},continueBackward:function(t){this.drawing()||(t=t||this.getDefaultLatLngs(),this.setDrawnLatLngs(t),t.length>0&&(this.tools.attachBackwardLineGuide(),this.tools.anchorBackwardLineGuide(t[0])),this.startDrawingBackward())},continueForward:function(t){this.drawing()||(t=t||this.getDefaultLatLngs(),this.setDrawnLatLngs(t),t.length>0&&(this.tools.attachForwardLineGuide(),this.tools.anchorForwardLineGuide(t[t.length-1])),this.startDrawingForward())},getDefaultLatLngs:function(t){return t=t||this.feature._latlngs,!t.length||t[0]instanceof T?t:this.getDefaultLatLngs(t[0])},ensureMulti:function(){this.feature._latlngs.length&&ir(this.feature._latlngs)&&(this.feature._latlngs=[this.feature._latlngs])},addNewEmptyShape:function(){if(this.feature._latlngs.length){var t=[];return this.appendShape(t),t}return this.feature._latlngs},formatShape:function(t){return ir(t)?t:t[0]?this.formatShape(t[0]):void 0},splitShape:function(t,e){if(e&&!(e>=t.length-1)){this.ensureMulti();var n=this.feature._latlngs.indexOf(t);if(-1!==n){var i=t.slice(0,e+1),o=t.slice(e);o[0]=A(o[0].lat,o[0].lng,o[0].alt),this.feature._latlngs.splice(n,1,i,o),this.refresh(),this.reset()}}}}),Xo.PolygonEditor=Xo.PathEditor.extend({CLOSED:!0,MIN_VERTEX:3,newPointForward:function(t){Xo.PathEditor.prototype.newPointForward.call(this,t),this.tools.backwardLineGuide._latlngs.length||this.tools.anchorBackwardLineGuide(t),2===this._drawnLatLngs.length&&this.tools.attachBackwardLineGuide()},addNewEmptyHole:function(t){this.ensureNotFlat();var e=this.feature.shapeAt(t);if(e){var n=[];return e.push(n),n}},newHole:function(t){var e=this.addNewEmptyHole(t);e&&(this.setDrawnLatLngs(e),this.startDrawingForward(),t&&this.newPointForward(t))},addNewEmptyShape:function(){if(this.feature._latlngs.length&&this.feature._latlngs[0].length){var t=[];return this.appendShape(t),t}return this.feature._latlngs},ensureMulti:function(){this.feature._latlngs.length&&ir(this.feature._latlngs[0])&&(this.feature._latlngs=[this.feature._latlngs])},ensureNotFlat:function(){this.feature._latlngs.length&&!ir(this.feature._latlngs)||(this.feature._latlngs=[this.feature._latlngs])},vertexCanBeDeleted:function(t){return g(this.feature.parentShape(t.latlngs),t.latlngs)>0||Xo.PathEditor.prototype.vertexCanBeDeleted.call(this,t)},getDefaultLatLngs:function(){return this.feature._latlngs.length||this.feature._latlngs.push([]),this.feature._latlngs[0]},formatShape:function(t){return!ir(t)||t[0]&&0===t[0].length?t:[t]}}),Xo.RectangleEditor=Xo.PathEditor.extend({CLOSED:!0,MIN_VERTEX:4,options:{skipMiddleMarkers:!0},extendBounds:function(t){var e=t.vertex.getIndex(),n=t.vertex.getNext(),i=t.vertex.getPrevious(),o=(e+2)%4,r=t.vertex.latlngs[o],s=E(t.latlng,r);i.latlng.update([t.latlng.lat,r.lng]),n.latlng.update([r.lat,t.latlng.lng]),this.updateBounds(s),this.refreshVertexMarkers()},onDrawingMouseDown:function(t){Xo.PathEditor.prototype.onDrawingMouseDown.call(this,t),this.connect();var e=this.getDefaultLatLngs();3===e.length&&e.push(t.latlng);var n=E(t.latlng,t.latlng);this.updateBounds(n),this.updateLatLngs(n),this.refresh(),this.reset(),t.originalEvent._simulated=!1,this.map.dragging._draggable._onUp(t.originalEvent),e[3].__vertex.dragging._draggable._onDown(t.originalEvent)},onDrawingMouseUp:function(t){this.commitDrawing(t),t.originalEvent._simulated=!1,Xo.PathEditor.prototype.onDrawingMouseUp.call(this,t)},onDrawingMouseMove:function(t){t.originalEvent._simulated=!1,Xo.PathEditor.prototype.onDrawingMouseMove.call(this,t)},getDefaultLatLngs:function(t){return t||this.feature._latlngs[0]},updateBounds:function(t){this.feature._bounds=t},updateLatLngs:function(t){for(var e=this.getDefaultLatLngs(),n=this.feature._boundsToLatLngs(t),i=0;i<e.length;i++)e[i].update(n[i])}}),Xo.CircleEditor=Xo.PathEditor.extend({MIN_VERTEX:2,options:{skipMiddleMarkers:!0},initialize:function(t,e,n){Xo.PathEditor.prototype.initialize.call(this,t,e,n),this._resizeLatLng=this.computeResizeLatLng()},computeResizeLatLng:function(){var t=(this.feature._radius||this.feature._mRadius)*Math.cos(Math.PI/4),e=this.map.project(this.feature._latlng);return this.map.unproject([e.x+t,e.y-t])},updateResizeLatLng:function(){this._resizeLatLng.update(this.computeResizeLatLng()),this._resizeLatLng.__vertex.update()},getLatLngs:function(){return[this.feature._latlng,this._resizeLatLng]},getDefaultLatLngs:function(){return this.getLatLngs()},onVertexMarkerDrag:function(t){1===t.vertex.getIndex()?this.resize(t):this.updateResizeLatLng(t),Xo.PathEditor.prototype.onVertexMarkerDrag.call(this,t)},resize:function(t){var e=this.feature._latlng.distanceTo(t.latlng);this.feature.setRadius(e)},onDrawingMouseDown:function(t){Xo.PathEditor.prototype.onDrawingMouseDown.call(this,t),this._resizeLatLng.update(t.latlng),this.feature._latlng.update(t.latlng),this.connect(),t.originalEvent._simulated=!1,this.map.dragging._draggable._onUp(t.originalEvent),this._resizeLatLng.__vertex.dragging._draggable._onDown(t.originalEvent)},onDrawingMouseUp:function(t){this.commitDrawing(t),t.originalEvent._simulated=!1,Xo.PathEditor.prototype.onDrawingMouseUp.call(this,t)},onDrawingMouseMove:function(t){t.originalEvent._simulated=!1,Xo.PathEditor.prototype.onDrawingMouseMove.call(this,t)},onDrag:function(t){Xo.PathEditor.prototype.onDrag.call(this,t),this.feature.dragging.updateLatLng(this._resizeLatLng)}});var Yo={createEditor:function(t){t=t||this._map;var e=(this.options.editOptions||{}).editTools||t.editTools;if(!e)throw Error("Unable to detect Editable instance.");return new(this.options.editorClass||this.getEditorClass(e))(t,this,this.options.editOptions)},enableEdit:function(t){return this.editor||this.createEditor(t),this.editor.enable(),this.editor},editEnabled:function(){return this.editor&&this.editor.enabled()},disableEdit:function(){this.editor&&(this.editor.disable(),delete this.editor)},toggleEdit:function(){this.editEnabled()?this.disableEdit():this.enableEdit()},_onEditableAdd:function(){this.editor&&this.enableEdit()}},$o={getEditorClass:function(t){return t&&t.options.polylineEditorClass?t.options.polylineEditorClass:Xo.PolylineEditor},shapeAt:function(t,e){var n=null;if(!(e=e||this._latlngs).length)return n;if(ir(e)&&this.isInLatLngs(t,e))n=e;else for(var i=0;i<e.length;i++)if(this.isInLatLngs(t,e[i]))return e[i];return n},isInLatLngs:function(t,e){if(!e)return!1;var n,i,o,r,s=[],a=this._clickTolerance();if(this._projectLatlngs(e,s,this._pxBounds),s=s[0],r=this._map.latLngToLayerPoint(t),!this._pxBounds.contains(r))return!1;for(n=1,o=s.length,i=0;n<o;i=n++)if(Z(r,s[i],s[n])<=a)return!0;return!1}},Jo={getEditorClass:function(t){return t&&t.options.polygonEditorClass?t.options.polygonEditorClass:Xo.PolygonEditor},shapeAt:function(t,e){var n=null;if(!(e=e||this._latlngs).length)return n;if(ir(e)&&this.isInLatLngs(t,e))n=e;else if(ir(e[0])&&this.isInLatLngs(t,e[0]))n=e;else for(var i=0;i<e.length;i++)if(this.isInLatLngs(t,e[i][0]))return e[i];return n},isInLatLngs:function(t,e){var n,i,o,r,s,a=!1;for(o=0,r=(s=e.length)-1;o<s;r=o++)n=e[o],i=e[r],n.lat>t.lat!=i.lat>t.lat&&t.lng<(i.lng-n.lng)*(t.lat-n.lat)/(i.lat-n.lat)+n.lng&&(a=!a);return a},parentShape:function(t,e){if(e=e||this._latlngs){var n=g(e,t);if(-1!==n)return e;for(var i=0;i<e.length;i++)if(-1!==(n=g(e[i],t)))return e[i]}}},Qo={getEditorClass:function(t){return t&&t.options.markerEditorClass?t.options.markerEditorClass:Xo.MarkerEditor}},tr={getEditorClass:function(t){return t&&t.options.rectangleEditorClass?t.options.rectangleEditorClass:Xo.RectangleEditor}},er={getEditorClass:function(t){return t&&t.options.circleEditorClass?t.options.circleEditorClass:Xo.CircleEditor}},nr=function(){this.on("add",this._onEditableAdd)},ir=U||K||qo._flat;qo&&(qo.include(Yo),qo.include($o),qo.addInitHook(nr)),Uo&&(Uo.include(Yo),Uo.include(Jo)),Vo&&(Vo.include(Yo),Vo.include(Qo),Vo.addInitHook(nr)),Ko&&(Ko.include(Yo),Ko.include(tr)),Go&&(Go.include(Yo),Go.include(er)),T.prototype.update=function(t){t=A(t),this.lat=t.lat,this.lng=t.lng};var or=s({},ui,{projection:{project:function(t){return new x(t.lng,t.lat)},unproject:function(t){return new T(t.y,t.x)},bounds:new M([-180,-90],[180,90])},transformation:Lt(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var n=e.lng-t.lng,i=e.lat-t.lat;return Math.sqrt(n*n+i*i)},infinite:!0}),rr=null,sr="ru",ar={invalid_svg_type:{ru:"   : {type}"},invalid_svg_content:{ru:"SVG-  "},no_svg_size:{ru:'SVG-    "width"  "height"'},no_svg_dimensions:{ru:' SVG-    "width", "height"   "viewBox"'}},hr="draw-distance",ur=null,lr=jo.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,n){this._url=t,this._bounds=E(e),_(this,n)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ct(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){kt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&Et(this._image),this},bringToBack:function(){return this._map&&Tt(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=E(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._image=Pt("img","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":"")+(this.options.className||""));t.onselectstart=c,t.onmousemove=c,t.onload=a(this.fire,this,"load"),t.onerror=a(this._overlayOnError,this,"error"),this.options.crossOrigin&&(t.crossOrigin=""),this.options.zIndex&&this._updateZIndex(),t.src=this._url,t.alt=this.options.alt},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),n=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;Ot(this._image,n,e)},_reset:function(){var t=this._image,e=new M(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),n=e.getSize();Zt(t,e.min),t.style.width=n.x+"px",t.style.height=n.y+"px"},_updateOpacity:function(){Bt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)}}),cr=function(t,e,n){return new lr(t,e,n)},dr=jo.extend({options:{padding:.1},initialize:function(t){_(this,t),h(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&Ct(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var n=this._map.getZoomScale(e,this._zoom),i=Rt(this._container),o=this._map.getSize().multiplyBy(.5+this.options.padding),r=this._map.project(this._center,e),s=this._map.project(t,e).subtract(r),a=o.multiplyBy(-n).add(i).add(o).subtract(s);Oi?Ot(this._container,a,n):Zt(this._container,a)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var t in this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),n=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new M(n,n.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),fr=dr.extend({getEvents:function(){var t=dr.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){dr.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");st(t,"mousemove",u(this._onMouseMove,32,this),this),st(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),st(t,"mouseout",this._handleMouseOut,this),this._ctx=t.getContext("2d")},_destroyContainer:function(){delete this._ctx,kt(this._container),at(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){this._redrawBounds=null;for(var t in this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={},dr.prototype._update.call(this);var t=this._bounds,e=this._container,n=t.getSize(),i=Hi?2:1;Zt(e,t.min),e.width=i*n.x,e.height=i*n.y,e.style.width=n.x+"px",e.style.height=n.y+"px",Hi&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){dr.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[h(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,n=e.next,i=e.prev;n?n.prev=i:this._drawLast=i,i?i.next=n:this._drawFirst=n,delete t._order,delete this._layers[L.stamp(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(t.options.dashArray){var e,n=t.options.dashArray.split(","),i=[];for(e=0;e<n.length;e++)i.push(Number(n[e]));t.options._dashArray=i}},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||y(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new M,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var n=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,n.x,n.y),this._ctx.clip()}this._drawing=!0;for(var i=this._drawFirst;i;i=i.next)t=i.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var n,i,o,r,s=t._parts,a=s.length,h=this._ctx;if(a){for(this._drawnLayers[t._leaflet_id]=t,h.beginPath(),n=0;n<a;n++){for(i=0,o=s[n].length;i<o;i++)r=s[n][i],h[i?"lineTo":"moveTo"](r.x,r.y);e&&h.closePath()}this._fillStroke(h,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var e=t._point,n=this._ctx,i=t._radius,o=(t._radiusY||i)/i;this._drawnLayers[t._leaflet_id]=t,1!==o&&(n.save(),n.scale(1,o)),n.beginPath(),n.arc(e.x,e.y/o,i,0,2*Math.PI,!1),1!==o&&n.restore(),this._fillStroke(n,t)}},_fillStroke:function(t,e){var n=e.options;n.fill&&(t.globalAlpha=n.fillOpacity,t.fillStyle=n.fillColor||n.color,t.fill(n.fillRule||"evenodd")),n.stroke&&0!==n.weight&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=n.opacity,t.lineWidth=n.weight,t.strokeStyle=n.color,t.lineCap=n.lineCap,t.lineJoin=n.lineJoin,t.stroke())},_onClick:function(t){for(var e,n,i=this._map.mouseEventToLayerPoint(t),o=this._drawFirst;o;o=o.next)(e=o.layer).options.interactive&&e._containsPoint(i)&&!this._map._draggableMoved(e)&&(n=e);n&&(mt(t),this._fireEvent([n],t))},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(St(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(t,e){for(var n,i,o=this._drawFirst;o;o=o.next)(n=o.layer).options.interactive&&n._containsPoint(e)&&(i=n);i!==this._hoveredLayer&&(this._handleMouseOut(t),i&&(Ct(this._container,"leaflet-interactive"),this._fireEvent([i],t,"mouseover"),this._hoveredLayer=i)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t)},_fireEvent:function(t,e,n){this._map._fireDOMEvent(e,n||e.type,t)},_bringToFront:function(t){var e=t._order,n=e.next,i=e.prev;n&&(n.prev=i,i?i.next=n:n&&(this._drawFirst=n),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t))},_bringToBack:function(t){var e=t._order,n=e.next,i=e.prev;i&&(i.next=n,n?n.prev=i:i&&(this._drawLast=i),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t))}}),pr=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_r={_initContainer:function(){this._container=Pt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(dr.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=pr("shape");Ct(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=pr("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[h(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;kt(e),t.removeInteractiveTarget(e),delete this._layers[h(t)]},_updateStyle:function(t){var e=t._stroke,n=t._fill,i=t.options,o=t._container;o.stroked=!!i.stroke,o.filled=!!i.fill,i.stroke?(e||(e=t._stroke=pr("stroke")),o.appendChild(e),e.weight=i.weight+"px",e.color=i.color,e.opacity=i.opacity,i.dashArray?e.dashStyle=ri(i.dashArray)?i.dashArray.join(" "):i.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=i.lineCap.replace("butt","flat"),e.joinstyle=i.lineJoin):e&&(o.removeChild(e),t._stroke=null),i.fill?(n||(n=t._fill=pr("fill")),o.appendChild(n),n.color=i.fillColor||i.color,n.opacity=i.fillOpacity):n&&(o.removeChild(n),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),n=Math.round(t._radius),i=Math.round(t._radiusY||n);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+n+","+i+" 0,"+65535*360)},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){Et(t._container)},_bringToBack:function(t){Tt(t._container)}},gr=qi?pr:z,mr=dr.extend({getEvents:function(){var t=dr.prototype.getEvents.call(this);return t.zoomstart=this._onZoomStart,t},_initContainer:function(){this._container=gr("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=gr("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){kt(this._container),at(this._container),delete this._container,delete this._rootGroup},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){dr.prototype._update.call(this);var t=this._bounds,e=t.getSize(),n=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,n.setAttribute("width",e.x),n.setAttribute("height",e.y)),Zt(n,t.min),n.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=gr("path");t.options.className&&Ct(e,t.options.className),t.options.interactive&&Ct(e,"leaflet-interactive"),this._updateStyle(t),this._layers[h(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){kt(t._path),t.removeInteractiveTarget(t._path),delete this._layers[h(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,n=t.options;e&&(n.stroke?(e.setAttribute("stroke",n.color),e.setAttribute("stroke-opacity",n.opacity),e.setAttribute("stroke-width",n.weight),e.setAttribute("stroke-linecap",n.lineCap),e.setAttribute("stroke-linejoin",n.lineJoin),n.dashArray?e.setAttribute("stroke-dasharray",n.dashArray):e.removeAttribute("stroke-dasharray"),n.dashOffset?e.setAttribute("stroke-dashoffset",n.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),n.fill?(e.setAttribute("fill",n.fillColor||n.color),e.setAttribute("fill-opacity",n.fillOpacity),e.setAttribute("fill-rule",n.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,D(t._parts,e))},_updateCircle:function(t){var e=t._point,n=t._radius,i="a"+n+","+(t._radiusY||n)+" 0 1,0 ",o=t._empty()?"M0 0":"M"+(e.x-n)+","+e.y+i+2*n+",0 "+i+2*-n+",0 ";this._setPath(t,o)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){Et(t._path)},_bringToBack:function(t){Tt(t._path)}});qi&&mr.include(_r),Po.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this.options.preferCanvas&&te()||ee()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||void 0===t)return!1;var e=this._paneRenderers[t];return void 0===e&&(e=mr&&ee({pane:t})||fr&&te({pane:t}),this._paneRenderers[t]=e),e}}),mr.create=gr,mr.pointsToPath=D;var vr=function(t){return null==t?ne:function(){return this.querySelector(t)}},yr=function(t){"function"!=typeof t&&(t=vr(t));for(var e=this._groups,n=e.length,i=new Array(n),o=0;o<n;++o)for(var r,s,a=e[o],h=a.length,u=i[o]=new Array(h),l=0;l<h;++l)(r=a[l])&&(s=t.call(r,r.__data__,l,a))&&("__data__"in r&&(s.__data__=r.__data__),u[l]=s);return new Xe(i,this._parents)},wr=function(t){return null==t?ie:function(){return this.querySelectorAll(t)}},xr=function(t){"function"!=typeof t&&(t=wr(t));for(var e=this._groups,n=e.length,i=[],o=[],r=0;r<n;++r)for(var s,a=e[r],h=a.length,u=0;u<h;++u)(s=a[u])&&(i.push(t.call(s,s.__data__,u,a)),o.push(s));return new Xe(i,o)},Lr=function(t){return function(){return this.matches(t)}};if("undefined"!=typeof document){var br=document.documentElement;if(!br.matches){var Mr=br.webkitMatchesSelector||br.msMatchesSelector||br.mozMatchesSelector||br.oMatchesSelector;Lr=function(t){return function(){return Mr.call(this,t)}}}}var Pr=Lr,kr=function(t){"function"!=typeof t&&(t=Pr(t));for(var e=this._groups,n=e.length,i=new Array(n),o=0;o<n;++o)for(var r,s=e[o],a=s.length,h=i[o]=[],u=0;u<a;++u)(r=s[u])&&t.call(r,r.__data__,u,s)&&h.push(r);return new Xe(i,this._parents)},Er=function(t){return new Array(t.length)},Tr=function(){return new Xe(this._enter||this._groups.map(Er),this._parents)};oe.prototype={constructor:oe,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var Ar=function(t){return function(){return t}},Cr="$",Sr=function(t,e){if(!t)return f=new Array(this.size()),u=-1,this.each(function(t){f[++u]=t}),f;var n=e?se:re,i=this._parents,o=this._groups;"function"!=typeof t&&(t=Ar(t));for(var r=o.length,s=new Array(r),a=new Array(r),h=new Array(r),u=0;u<r;++u){var l=i[u],c=o[u],d=c.length,f=t.call(l,l&&l.__data__,u,i),p=f.length,_=a[u]=new Array(p),g=s[u]=new Array(p);n(l,c,_,g,h[u]=new Array(d),f,e);for(var m,v,y=0,w=0;y<p;++y)if(m=_[y]){for(y>=w&&(w=y+1);!(v=g[w])&&++w<p;);m._next=v||null}}return s=new Xe(s,i),s._enter=a,s._exit=h,s},zr=function(){return new Xe(this._exit||this._groups.map(Er),this._parents)},Dr=function(t){for(var e=this._groups,n=t._groups,i=e.length,o=n.length,r=Math.min(i,o),s=new Array(i),a=0;a<r;++a)for(var h,u=e[a],l=n[a],c=u.length,d=s[a]=new Array(c),f=0;f<c;++f)(h=u[f]||l[f])&&(d[f]=h);for(;a<i;++a)s[a]=e[a];return new Xe(s,this._parents)},Br=function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,o=t[e],r=o.length-1,s=o[r];--r>=0;)(i=o[r])&&(s&&s!==i.nextSibling&&s.parentNode.insertBefore(i,s),s=i);return this},Ir=function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=ae);for(var n=this._groups,i=n.length,o=new Array(i),r=0;r<i;++r){for(var s,a=n[r],h=a.length,u=o[r]=new Array(h),l=0;l<h;++l)(s=a[l])&&(u[l]=s);u.sort(e)}return new Xe(o,this._parents).order()},Nr=function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},Or=function(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t},Zr=function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],o=0,r=i.length;o<r;++o){var s=i[o];if(s)return s}return null},Rr=function(){var t=0;return this.each(function(){++t}),t},jr=function(){return!this.node()},Fr=function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var o,r=e[n],s=0,a=r.length;s<a;++s)(o=r[s])&&t.call(o,o.__data__,s,r);return this},Vr="http://www.w3.org/1999/xhtml",Hr={svg:"http://www.w3.org/2000/svg",xhtml:Vr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Wr=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),Hr.hasOwnProperty(e)?{space:Hr[e],local:t}:t},Gr=function(t,e){var n=Wr(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?ue:he:"function"==typeof e?n.local?fe:de:n.local?ce:le)(n,e))},qr=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView},Ur=function(t,e,n){return arguments.length>1?this.each((null==e?pe:"function"==typeof e?ge:_e)(t,e,null==n?"":n)):me(this.node(),t)},Kr=function(t,e){return arguments.length>1?this.each((null==e?ve:"function"==typeof e?we:ye)(t,e)):this.node()[t]};be.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Xr=function(t,e){var n=xe(t+"");if(arguments.length<2){for(var i=Le(this.node()),o=-1,r=n.length;++o<r;)if(!i.contains(n[o]))return!1;return!0}return this.each(("function"==typeof e?Te:e?ke:Ee)(n,e))},Yr=function(t){return arguments.length?this.each(null==t?Ae:("function"==typeof t?Se:Ce)(t)):this.node().textContent},$r=function(t){return arguments.length?this.each(null==t?ze:("function"==typeof t?Be:De)(t)):this.node().innerHTML},Jr=function(){return this.each(Ie)},Qr=function(){return this.each(Ne)},ts=function(t){var e=Wr(t);return(e.local?Ze:Oe)(e)},es=function(t){var e="function"==typeof t?t:ts(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},ns=function(t,e){var n="function"==typeof t?t:ts(t),i=null==e?Re:"function"==typeof e?e:vr(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})},is=function(){return this.each(je)},os=function(t){return arguments.length?this.property("__data__",t):this.node().__data__},rs={},ss=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(rs={mouseenter:"mouseover",mouseleave:"mouseout"}));var as=function(t,e,n){var i,o,r=He(t+""),s=r.length;{if(!(arguments.length<2)){for(a=e?Ge:We,null==n&&(n=!1),i=0;i<s;++i)this.each(a(r[i],e,n));return this}var a=this.node().__on;if(a)for(var h,u=0,l=a.length;u<l;++u)for(i=0,h=a[u];i<s;++i)if((o=r[i]).type===h.type&&o.name===h.name)return h.value}},hs=function(t,e){return this.each(("function"==typeof e?Ke:Ue)(t,e))},us=[null];Xe.prototype=Ye.prototype={constructor:Xe,select:yr,selectAll:xr,filter:kr,data:Sr,enter:Tr,exit:zr,merge:Dr,order:Br,sort:Ir,call:Nr,nodes:Or,node:Zr,size:Rr,empty:jr,each:Fr,attr:Gr,style:Ur,property:Kr,classed:Xr,text:Yr,html:$r,raise:Jr,lower:Qr,append:es,insert:ns,remove:is,datum:os,on:as,dispatch:hs};var ls=function(t){return"string"==typeof t?new Xe([[document.querySelector(t)]],[document.documentElement]):new Xe([[t]],us)},cs=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},ds=function(t){return 1===t.length&&(t=$e(t)),{left:function(e,n,i,o){for(null==i&&(i=0),null==o&&(o=e.length);i<o;){var r=i+o>>>1;t(e[r],n)<0?i=r+1:o=r}return i},right:function(e,n,i,o){for(null==i&&(i=0),null==o&&(o=e.length);i<o;){var r=i+o>>>1;t(e[r],n)>0?o=r:i=r+1}return i}}}(cs).right,fs=Math.sqrt(50),ps=Math.sqrt(10),_s=Math.sqrt(2),gs=function(t,e,n){var i,o,r,s=e<t,a=-1;if(s&&(i=t,t=e,e=i),0===(r=Je(t,e,n))||!isFinite(r))return[];if(r>0)for(t=Math.ceil(t/r),e=Math.floor(e/r),o=new Array(i=Math.ceil(e-t+1));++a<i;)o[a]=(t+a)*r;else for(t=Math.floor(t*r),e=Math.ceil(e*r),o=new Array(i=Math.ceil(t-e+1));++a<i;)o[a]=(t-a)/r;return s&&o.reverse(),o},ms=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t},vs=.7,ys=1/vs,ws="\\s*([+-]?\\d+)\\s*",xs="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ls="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",bs=/^#([0-9a-f]{3})$/,Ms=/^#([0-9a-f]{6})$/,Ps=new RegExp("^rgb\\("+[ws,ws,ws]+"\\)$"),ks=new RegExp("^rgb\\("+[Ls,Ls,Ls]+"\\)$"),Es=new RegExp("^rgba\\("+[ws,ws,ws,xs]+"\\)$"),Ts=new RegExp("^rgba\\("+[Ls,Ls,Ls,xs]+"\\)$"),As=new RegExp("^hsl\\("+[xs,Ls,Ls]+"\\)$"),Cs=new RegExp("^hsla\\("+[xs,Ls,Ls,xs]+"\\)$"),Ss={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ms(en,nn,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),ms(hn,an,tn(en,{brighter:function(t){return t=null==t?ys:Math.pow(ys,t),new hn(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?vs:Math.pow(vs,t),new hn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(1===t?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),ms(dn,cn,tn(en,{brighter:function(t){return t=null==t?ys:Math.pow(ys,t),new dn(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?vs:Math.pow(vs,t),new dn(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,o=2*n-i;return new hn(fn(t>=240?t-240:t+120,o,i),fn(t,o,i),fn(t<120?t+240:t-120,o,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var zs=Math.PI/180,Ds=180/Math.PI,Bs=18,Is=.95047,Ns=1,Os=1.08883,Zs=4/29,Rs=6/29,js=3*Rs*Rs,Fs=Rs*Rs*Rs;ms(gn,_n,tn(en,{brighter:function(t){return new gn(this.l+Bs*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new gn(this.l-Bs*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return t=Ns*vn(t),e=Is*vn(e),n=Os*vn(n),new hn(yn(3.2404542*e-1.5371385*t-.4985314*n),yn(-.969266*e+1.8760108*t+.041556*n),yn(.0556434*e-.2040259*t+1.0572252*n),this.opacity)}})),ms(bn,Ln,tn(en,{brighter:function(t){return new bn(this.h,this.c,this.l+Bs*(null==t?1:t),this.opacity)},darker:function(t){return new bn(this.h,this.c,this.l-Bs*(null==t?1:t),this.opacity)},rgb:function(){return pn(this).rgb()}}));var Vs=-.14861,Hs=+1.78277,Ws=-.29227,Gs=-.90649,qs=+1.97294,Us=qs*Gs,Ks=qs*Hs,Xs=Hs*Ws-Gs*Vs;ms(kn,Pn,tn(en,{brighter:function(t){return t=null==t?ys:Math.pow(ys,t),new kn(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?vs:Math.pow(vs,t),new kn(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*zs,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),i=Math.cos(t),o=Math.sin(t);return new hn(255*(e+n*(Vs*i+Hs*o)),255*(e+n*(Ws*i+Gs*o)),255*(e+n*(qs*i)),this.opacity)}}));var Ys=function(t){return function(){return t}},$s=function t(e){function n(t,e){var n=i((t=an(t)).r,(e=an(e)).r),o=i(t.g,e.g),r=i(t.b,e.b),s=Sn(t.opacity,e.opacity);return function(e){return t.r=n(e),t.g=o(e),t.b=r(e),t.opacity=s(e),t+""}}var i=Cn(e);return n.gamma=t,n}(1),Js=function(t,e){var n,i=e?e.length:0,o=t?Math.min(i,t.length):0,r=new Array(i),s=new Array(i);for(n=0;n<o;++n)r[n]=ra(t[n],e[n]);for(;n<i;++n)s[n]=e[n];return function(t){for(n=0;n<o;++n)s[n]=r[n](t);return s}},Qs=function(t,e){var n=new Date;return t=+t,e-=t,function(i){return n.setTime(t+e*i),n}},ta=function(t,e){return t=+t,e-=t,function(n){return t+e*n}},ea=function(t,e){var n,i={},o={};null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={});for(n in e)n in t?i[n]=ra(t[n],e[n]):o[n]=e[n];return function(t){for(n in i)o[n]=i[n](t);return o}},na=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ia=new RegExp(na.source,"g"),oa=function(t,e){var n,i,o,r=na.lastIndex=ia.lastIndex=0,s=-1,a=[],h=[];for(t+="",e+="";(n=na.exec(t))&&(i=ia.exec(e));)(o=i.index)>r&&(o=e.slice(r,o),a[s]?a[s]+=o:a[++s]=o),(n=n[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,h.push({i:s,x:ta(n,i)})),r=ia.lastIndex;return r<e.length&&(o=e.slice(r),a[s]?a[s]+=o:a[++s]=o),a.length<2?h[0]?Dn(h[0].x):zn(e):(e=h.length,function(t){for(var n,i=0;i<e;++i)a[(n=h[i]).i]=n.x(t);return a.join("")})},ra=function(t,e){var n,i=typeof e;return null==e||"boolean"===i?Ys(e):("number"===i?ta:"string"===i?(n=nn(e))?(e=n,$s):oa:e instanceof nn?$s:e instanceof Date?Qs:Array.isArray(e)?Js:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?ea:ta)(t,e)},sa=function(t,e){return t=+t,e-=t,function(n){return Math.round(t+e*n)}};Bn(An);Bn(Sn);var aa,ha=Array.prototype,ua=ha.map,la=ha.slice,ca=function(t){return function(){return t}},da=function(t){return+t},fa=[0,1],pa=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]},_a=function(t){return t=pa(Math.abs(t)),t?t[1]:NaN},ga=function(t,e){return function(n,i){for(var o=n.length,r=[],s=0,a=t[0],h=0;o>0&&a>0&&(h+a+1>i&&(a=Math.max(1,i-h)),r.push(n.substring(o-=a,o+a)),!((h+=a+1)>i));)a=t[s=(s+1)%t.length];return r.reverse().join(e)}},ma=function(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}},va=function(t,e){var n=pa(t,e);if(!n)return t+"";var i=n[0],o=n[1];return o<0?"0."+new Array(-o).join("0")+i:i.length>o+1?i.slice(0,o+1)+"."+i.slice(o+1):i+new Array(o-i.length+2).join("0")},ya={"":function(t,e){t:for(var n,i=(t=t.toPrecision(e)).length,o=1,r=-1;o<i;++o)switch(t[o]){case".":r=n=o;break;case"0":0===r&&(r=o),n=o;break;case"e":break t;default:r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(n+1):t},"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return va(100*t,e)},r:va,s:function(t,e){var n=pa(t,e);if(!n)return t+"";var i=n[0],o=n[1],r=o-(aa=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,s=i.length;return r===s?i:r>s?i+new Array(r-s+1).join("0"):r>0?i.slice(0,r)+"."+i.slice(r):"0."+new Array(1-r).join("0")+pa(t,Math.max(0,e+r-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},wa=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;Vn.prototype=Hn.prototype,Hn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var xa,La,ba,Ma=function(t){return t},Pa=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"],ka=function(t){function e(t){function e(t){var e,o,a,l=g,w=m;if("c"===_)w=v(t)+w,t="";else{var x=(t=+t)<0;if(t=v(Math.abs(t),p),x&&0==+t&&(x=!1),l=(x?"("===u?u:"-":"-"===u||"("===u?"":u)+l,w=w+("s"===_?Pa[8+aa/3]:"")+(x&&"("===u?")":""),y)for(e=-1,o=t.length;++e<o;)if(48>(a=t.charCodeAt(e))||a>57){w=(46===a?r+t.slice(e+1):t.slice(e))+w,t=t.slice(0,e);break}}f&&!c&&(t=i(t,1/0));var L=l.length+t.length+w.length,b=L<d?new Array(d-L+1).join(n):"";switch(f&&c&&(t=i(b+t,b.length?d-w.length:1/0),b=""),h){case"<":t=l+t+w+b;break;case"=":t=l+b+t+w;break;case"^":t=b.slice(0,L=b.length>>1)+l+t+w+b.slice(L);break;default:t=b+l+t+w}return s(t)}var n=(t=Vn(t)).fill,h=t.align,u=t.sign,l=t.symbol,c=t.zero,d=t.width,f=t.comma,p=t.precision,_=t.type,g="$"===l?o[0]:"#"===l&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",m="$"===l?o[1]:/[%p]/.test(_)?a:"",v=ya[_],y=!_||/[defgprs%]/.test(_);return p=null==p?_?6:12:/[gprs]/.test(_)?Math.max(1,Math.min(21,p)):Math.max(0,Math.min(20,p)),e.toString=function(){return t+""},e}function n(t,n){var i=e((t=Vn(t),t.type="f",t)),o=3*Math.max(-8,Math.min(8,Math.floor(_a(n)/3))),r=Math.pow(10,-o),s=Pa[8+o/3];return function(t){return i(r*t)+s}}var i=t.grouping&&t.thousands?ga(t.grouping,t.thousands):Ma,o=t.currency,r=t.decimal,s=t.numerals?ma(t.numerals):Ma,a=t.percent||"%";return{format:e,formatPrefix:n}};!function(t){xa=ka(t),La=xa.format,ba=xa.formatPrefix}({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var Ea=function(t){return Math.max(0,-_a(Math.abs(t)))},Ta=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(_a(e)/3)))-_a(Math.abs(t)))},Aa=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,_a(e)-_a(t))+1},Ca=function(t,e,n){var i,o=t[0],r=t[t.length-1],s=Qe(o,r,null==e?10:e);switch((n=Vn(null==n?",f":n)).type){case"s":var a=Math.max(Math.abs(o),Math.abs(r));return null!=n.precision||isNaN(i=Ta(s,a))||(n.precision=i),ba(n,a);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(i=Aa(s,Math.max(Math.abs(o),Math.abs(r))))||(n.precision=i-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(i=Ea(s))||(n.precision=i-2*("%"===n.type))}return La(n)},Sa=Array.prototype.slice,za=function(t){return t},Da=1,Ba=2,Ia=3,Na=4,Oa=1e-6,Za=Ko.extend({options:{color:"grey",weight:1,fill:!1,className:"grid-axis"},onAdd:function(t){var e=t.getRenderer(this)._rootGroup;this.$axis=ls(e).append("g").attr("class","grid").style("pointer-events","none"),this._addAxis(t),Ko.prototype.onAdd.call(this,t),t.on("move",this._updateAxis,this)},onRemove:function(t){this.$axis.remove(),this.$graphPanel.remove(),t.off("move",this._updateAxis,this),Ko.prototype.onRemove.call(this,t)},_addAxis:function(t){var e=function(t){return t+" "},n=t._container.getBoundingClientRect(),i={left:50,right:0,top:5,bottom:30};this.$graphPanel=ls("body").append("svg").style("position","absolute").style("top",n.top-i.top+"px").style("left",n.left-i.left-1+"px").style("height",n.height+i.top+i.bottom+"px").style("width",n.width+i.left+i.right+"px").style("pointer-events","none").style("z-index","399"),this.$axisX=this.$graphPanel.append("g").attr("class","x axis").attr("transform","translate("+i.left+","+(i.top+n.height)+")"),this.scaleX=Gn().range([0,n.width]),this.axisX=Jn(this.scaleX).ticks(10).tickFormat(e),this.$axisY=this.$graphPanel.append("g").attr("class","y axis").attr("transform","translate("+i.left+","+i.top+")"),this.scaleY=Gn().range([n.height,0]),this.axisY=Qn(this.scaleY).ticks(10).tickFormat(e)},_updateAxis:function(){var t=this._map.getBounds(),e=this.getBounds();this.scaleX.domain([t.getWest()-e.getWest(),t.getEast()-e.getWest()]),this.$axisX.call(this.axisX),this.scaleY.domain([e.getNorth()-t.getNorth(),e.getNorth()-t.getSouth()]),this.$axisY.call(this.axisY)},_updatePath:function(){this._map;Ko.prototype._updatePath.call(this);var t=this.step,e=P(this._parts[0]),n=e.getTopLeft(),i=e.getBottomRight(),o=0,r=0;t>2&&(o=Math.ceil((i.x-n.x)/t),r=Math.ceil((i.y-n.y)/t));var s=this.$axis.selectAll("line.x").data(ti.range(1,o));s.exit().remove(),s.enter().append("line").style("stroke",this.options.color).style("stroke-width",this.options.weight).attr("class","grid-axis x").merge(s).attr("y1",n.y).attr("y2",i.y).attr("x1",function(e){return n.x+e*t}).attr("x2",function(e){return n.x+e*t});var a=this.$axis.selectAll("line.y").data(ti.range(1,r));a.exit().remove(),a.enter().append("line").style("stroke",this.options.color).style("stroke-width",this.options.weight).attr("class","grid-axis y").merge(a).attr("y1",function(e){return n.y+e*t}).attr("y2",function(e){return n.y+e*t}).attr("x1",n.x).attr("x2",i.x),this._updateAxis()},_project:function(){if(this._map){var t=this._map.latLngToContainerPoint(A(0,0)),e=this._map.latLngToContainerPoint(A(0,.5));if((n=t.distanceTo(e))<5){var t=this._map.latLngToContainerPoint(A(0,0)),e=this._map.latLngToContainerPoint(A(0,1));if((n=t.distanceTo(e))<5)var t=this._map.latLngToContainerPoint(A(0,0)),e=this._map.latLngToContainerPoint(A(0,5)),n=t.distanceTo(e);if(n<5)var t=this._map.latLngToContainerPoint(A(0,0)),e=this._map.latLngToContainerPoint(A(0,10)),n=t.distanceTo(e)}this.step=n>5?n:5}Ko.prototype._project.call(this)}}),Ra=jo.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(t,e){_(this,t),this._source=e},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&Bt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&Bt(this._container,1),this.bringToFront()},onRemove:function(t){t._fadeAnimated?(Bt(this._container,0),this._removeTimeout=setTimeout(a(kt,void 0,this._container),200)):kt(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=A(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Et(this._container),this},bringToBack:function(){return this._map&&Tt(this._container),this},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=b(this.options.offset),n=this._getAnchor();this._zoomAnimated?Zt(this._container,t.add(n)):e=e.add(t).add(n);var i=this._containerBottom=-e.y,o=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=i+"px",this._container.style.left=o+"px"}},_getAnchor:function(){return[0,0]}}),ja=Ho.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Ho.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Ho.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new k;for(var e in this._layers){var n=this._layers[e];t.extend(n.getBounds?n.getBounds():n.getLatLng())}return t}}),Fa=Ra.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(t){Ra.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(t){Ra.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var t=Ra.prototype.getEvents.call(this);return Fi&&!this.options.permanent&&(t.preclick=this._close),t},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var t="leaflet-tooltip"+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Pt("div",t)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e=this._map,n=this._container,i=e.latLngToContainerPoint(e.getCenter()),o=e.layerPointToContainerPoint(t),r=this.options.direction,s=n.offsetWidth,a=n.offsetHeight,h=b(this.options.offset),u=this._getAnchor();"top"===r?t=t.add(b(-s/2+h.x,-a+h.y+u.y,!0)):"bottom"===r?t=t.subtract(b(s/2-h.x,-h.y,!0)):"center"===r?t=t.subtract(b(s/2+h.x,a/2-u.y+h.y,!0)):"right"===r||"auto"===r&&o.x<i.x?(r="right",t=t.add(b(h.x+u.x,u.y-a/2+h.y,!0))):(r="left",t=t.subtract(b(s+u.x-h.x,a/2-u.y-h.y,!0))),St(n,"leaflet-tooltip-right"),St(n,"leaflet-tooltip-left"),St(n,"leaflet-tooltip-top"),St(n,"leaflet-tooltip-bottom"),Ct(n,"leaflet-tooltip-"+r),Zt(n,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&Bt(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return b(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Va=function(t,e){return new Fa(t,e)};Po.include({openTooltip:function(t,e,n){return t instanceof Fa||(t=new Fa(n).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:this.addLayer(t)},closeTooltip:function(t){return t&&this.removeLayer(t),this}}),jo.include({bindTooltip:function(t,e){return t instanceof Fa?(_(t,e),this._tooltip=t,t._source=this):(this._tooltip&&!e||(this._tooltip=new Fa(e,this)),this._tooltip.setContent(t)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",n={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?n.add=this._openTooltip:(n.mouseover=this._openTooltip,n.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(n.mousemove=this._moveTooltip),Fi&&(n.click=this._openTooltip)),this[e](n),this._tooltipHandlersAdded=!t}},openTooltip:function(t,e){if(t instanceof jo||(e=t,t=this),t instanceof ja)for(var n in this._layers){t=this._layers[n];break}return e||(e=t.getCenter?t.getCenter():t.getLatLng()),this._tooltip&&this._map&&(this._tooltip._source=t,this._tooltip.update(),this._map.openTooltip(this._tooltip,e),this._tooltip.options.interactive&&this._tooltip._container&&(Ct(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(St(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(t){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(t)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_openTooltip:function(t){var e=t.layer||t.target;this._tooltip&&this._map&&this.openTooltip(e,this._tooltip.options.sticky?t.latlng:void 0)},_moveTooltip:function(t){var e,n,i=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),n=this._map.containerPointToLayerPoint(e),i=this._map.layerPointToLatLng(n)),this._tooltip.setLatLng(i)}});var Ha=Ra.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,className:""},openOn:function(t){return t.openPopup(this),this},onAdd:function(t){Ra.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Wo||this._source.on("preclick",lt))},onRemove:function(t){Ra.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Wo||this._source.off("preclick",lt))},getEvents:function(){var t=Ra.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",e=this._container=Pt("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),n=this._wrapper=Pt("div",t+"-content-wrapper",e);if(this._contentNode=Pt("div",t+"-content",n),dt(n),ct(this._contentNode),st(n,"contextmenu",lt),this._tipContainer=Pt("div",t+"-tip-container",e),this._tip=Pt("div",t+"-tip",this._tipContainer),this.options.closeButton){var i=this._closeButton=Pt("a",t+"-close-button",e);i.href="#close",i.innerHTML="&#215;",st(i,"click",this._onCloseButtonClick,this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var n=t.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),e.width=n+1+"px",e.whiteSpace="",e.height="";var i=t.offsetHeight,o=this.options.maxHeight,r="leaflet-popup-scrolled";o&&i>o?(e.height=o+"px",Ct(t,r)):St(t,r),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),n=this._getAnchor();Zt(this._container,e.add(n))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var t=this._map,e=parseInt(Mt(this._container,"marginBottom"),10)||0,n=this._container.offsetHeight+e,i=this._containerWidth,o=new x(this._containerLeft,-n-this._containerBottom);o._add(Rt(this._container));var r=t.layerPointToContainerPoint(o),s=b(this.options.autoPanPadding),a=b(this.options.autoPanPaddingTopLeft||s),h=b(this.options.autoPanPaddingBottomRight||s),u=t.getSize(),l=0,c=0;r.x+i+h.x>u.x&&(l=r.x+i-u.x+h.x),r.x-l-a.x<0&&(l=r.x-a.x),r.y+n+h.y>u.y&&(c=r.y+n-u.y+h.y),r.y-c-a.y<0&&(c=r.y-a.y),(l||c)&&t.fire("autopanstart").panBy([l,c])}},_onCloseButtonClick:function(t){this._close(),pt(t)},_getAnchor:function(){return b(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Wa=function(t,e){return new Ha(t,e)};Po.mergeOptions({closePopupOnClick:!0}),Po.include({openPopup:function(t,e,n){return t instanceof Ha||(t=new Ha(n).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),jo.include({bindPopup:function(t,e){return t instanceof Ha?(_(t,e),this._popup=t,t._source=this):(this._popup&&!e||(this._popup=new Ha(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t,e){if(t instanceof jo||(e=t,t=this),t instanceof ja)for(var n in this._layers){t=this._layers[n];break}return e||(e=t.getCenter?t.getCenter():t.getLatLng()),this._popup&&this._map&&(this._popup._source=t,this._popup.update(),this._map.openPopup(this._popup,e)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(t){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(t)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){var e=t.layer||t.target;this._popup&&this._map&&(pt(t),e instanceof Wo?this.openPopup(t.layer||t.target,t.latlng):this._map.hasLayer(this._popup)&&this._popup._source===e?this.closePopup():this.openPopup(e,t.latlng))},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}}),console.log(typeof Va,typeof Wa);var Ga=function(e,n){function i(t){return t._redux_id=t._redux_id||++a,t._redux_id}n=n||[];var o=function(t,e){return o.dispatch({type:t,payload:e})};o.state={};var r=[],s={},a=0;return o.on=function(t,e){t.split(" ").forEach(function(t){var n=t.trim().split("."),o=t+"."+i(e);r.push(o),s[o]={path:n,fn:e}})},o.off=function(t,e){var n=t.split(" ").map(function(t){var n=t.trim()+"."+i(e);return delete s[n],n});r=ti.difference(r,n)},o.dispatch=function(n){var i=o.state;if(o.state=e(o.state,n),o.state!==i){var a=t(o.state,i);r.forEach(function(t){var e=s[t];e&&a(e.path).forEach(function(t){e.fn(t)})})}return o.state},n.forEach(function(t){o.dispatch=t(o)(o.dispatch)}),o}(function(t){return function(e,n){return t.forEach(function(t){e=t(e,n)}),e}}([vi,yi]));Ga.state=ei,window.store=Ga;var qa=function(t,e){return rr=new Po(t,{crs:or,zoomControl:!1,attributionControl:!1,editable:!0}),window.map=rr,rr.ll2cp=rr.latLngToContainerPoint,rr.ll2lp=rr.latLngToLayerPoint,rr=Kt(rr),rr.toPoints=function(t){return(t=ti.flatten(t)).map(rr.snap).map(function(t){return[t.lng,t.lat]})},rr.inqueue_on("click",function(){e(ci)}),e.on("map.size_m",function(t){Xt(t.new_val)}),rr}("map",Ga);!function(t){var e=function(t){return document.getElementById(t)},n=function(t){e(t).style.display=""},i=function(t){e(t).style.display="none"},o=function(t,n){e(t).innerHTML=n},r=function(t,n){e(t).innerText=n},s=function(t,n){e(t).value=n};e("file").onchange=Qt(t,function(t){o("error",t)}),e("draw_line").onclick=function(){t(mi,hr)},e("distance_input").oninput=ti.debounce(function(n){var i=parseInt(e("distance_input").value);!Number.isNaN(i)&&i>0&&t(gi,i)},500),t.on("selectedBase.size_m",function(t){if(t.new_val){var e=t.new_val;n("toolbar"),n("size"),r("size_input",Math.round(e.x)+"x"+Math.round(e.y))}}),t.on("selectedBase.distance",function(t){t.new_val&&(i("draw_line"),n("distance"),s("distance_input",t.new_val.length_m))})}(Ga),function(t,e){var n={baseLayer:null,grid:null};t.on("selectedBase.url",function(i){var r=i.new_val;if(n.baseLayer&&(e.removeLayer(n.baseLayer),n.baseLayer=null,e.removeLayer(n.grid),n.grid=null),r){var s=o(t).size_m,a=E([[0,0],[s.y,s.x]]);n.baseLayer=cr(r,a,{crossOrigin:!0}).addTo(e),e.fitBounds(a)}}),t.on("selectedBase.size_m",function(t){var e=t.new_val;if(n.baseLayer&&e){var i=E([[0,0],[e.y,e.x]]);n.baseLayer.setBounds(i)}}),t.on("selectedBase.grid",function(t){if(t.new_val){var i=t.new_val,o=E(S([i.topLeft,i.bottomRight])),r=[o.getSouthWest(),o.getNorthWest(),o.getNorthEast(),o.getSouthEast()];n.grid?n.grid.setLatLngs(r):n.grid=new Za(r).addTo(e)}})}(Ga,qa),function(t,e){function n(n){var o=n.layer;if(2==o.getLatLngs().length){var r=o.getLatLngs();e.editTools.commitDrawing();var s=r.map(function(t){return e.project(t,1)}),a=s[0].distanceTo(s[1]),h=Math.round(or.distance(r[0],r[1]));i(h),t(_i,{length_px:a,length_m:h,points:s}),t(mi,null)}}function i(t){var e=t+" m";r.getTooltip()?r.getTooltip().setLatLng(r.getCenter()).setContent(e):r.bindTooltip(e,{permanent:!0,interactive:!0})}var r=null;t.on("map.drawMode",function(t){t.new_val==hr?(_(e.editTools,{skipMiddleMarkers:!0}),(r=e.editTools.startPolyline(void 0,{weight:2,color:"red",dashArray:"5,10"})).on("editable:editing",n)):t.old_val==hr&&_(e.editTools,{skipMiddleMarkers:!1})}),t.on("selectedBase.distance",function(t){t.new_val&&t.new_val.points||r&&(r.disableEdit(),e.removeLayer(r),r=null)}),t.on("selectedBase.size_m",function(n){if(r&&n.new_val&&o(t).distance){var s=o(t).distance.points.map(function(t){return e.unproject(t,1)});r.disableEdit(),r.setLatLngs(s),r.enableEdit(e),i(o(t).distance.length_m)}})}(Ga,qa),Ga("INIT")}();